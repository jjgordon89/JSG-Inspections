"use strict";(self.webpackChunkjsg_inspections=self.webpackChunkjsg_inspections||[]).push([[953],{3953:(t,e,i)=>{i.d(e,{Bc:()=>d,EJ:()=>n,M6:()=>r,NC:()=>l,NN:()=>c,R8:()=>s,gJ:()=>a,v5:()=>x});var o=i(7762);const n=t=>{const e=new o.Ay;e.setFontSize(18),e.text("Equipment Report",20,20),e.setFontSize(12);let i=35;e.text(`Equipment ID: ${t.equipment_id||"N/A"}`,20,i),i+=7,e.text(`Type: ${t.type||"N/A"}`,20,i),i+=7,e.text(`Manufacturer: ${t.manufacturer||"N/A"}`,20,i),i+=7,e.text(`Model: ${t.model||"N/A"}`,20,i),i+=7,e.text(`Serial Number: ${t.serial_number||"N/A"}`,20,i),i+=7,e.text(`Capacity: ${t.capacity||"N/A"}`,20,i),i+=7,e.text(`Installation Date: ${t.installation_date||"N/A"}`,20,i),i+=7,e.text(`Location: ${t.location||"N/A"}`,20,i),i+=7,e.text(`Status: ${t.status||"N/A"}`,20,i),e.save(`${t.equipment_id||"equipment"}_report.pdf`)},a=async(t,e)=>{const i=new o.Ay;let n=20;i.setFontSize(18),i.text("Inspection History Report",20,n),n+=10,i.setFontSize(14),i.text(`Equipment: ${t.equipment_id||"N/A"}`,20,n),n+=15,i.setFontSize(12),i.text(`Manufacturer: ${t.manufacturer||"N/A"}`,20,n),i.text(`Model: ${t.model||"N/A"}`,100,n),n+=7,i.text(`Serial Number: ${t.serial_number||"N/A"}`,20,n),i.text(`Capacity: ${t.capacity||"N/A"} lbs`,100,n),n+=7,i.text(`Location: ${t.location||"N/A"}`,20,n),n+=14,i.setFontSize(14),i.text("Inspection Records",20,n),n+=7,i.setFontSize(10),i.text("Date",20,n),i.text("Inspector",60,n),i.text("Items",100,n),i.text("Failures",130,n),i.text("Result",160,n),n+=7,i.line(20,n-2,190,n-2);for(const o of e){n>270&&(i.addPage(),n=20);try{const t=await window.api.secureOperation("inspectionItems.getByInspectionId",{inspectionId:o.id}),e=t.length,a=t.filter(t=>"fail"===t.result).length,r=0===a?"Pass":"Fail";i.text(o.inspection_date||"N/A",20,n),i.text(o.inspector||"N/A",60,n),i.text(String(e),100,n),i.text(String(a),130,n),i.setTextColor("Pass"===r?"green":"red"),i.text(r,160,n),i.setTextColor("black"),n+=7}catch(a){console.error("Error processing inspection items:",a);let t=[];try{t=JSON.parse(o.findings||"[]")}catch(r){t=[]}const e=t.flatMap(t=>t.items||[]),s=e.filter(t=>"fail"===t.result),c=0===s.length?"Pass":"Fail";i.text(o.inspection_date||"N/A",20,n),i.text(o.inspector||"N/A",60,n),i.text(String(e.length),100,n),i.text(String(s.length),130,n),i.setTextColor("Pass"===c?"green":"red"),i.text(c,160,n),i.setTextColor("black"),n+=7}}i.save(`history_report_${t.equipment_id||"equipment"}.pdf`)},r=async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{includeSummary:i=!0,includeDeficiencies:n=!0,includeComments:a=!0,includeSignature:r=!0,logo:s}=e,c=new o.Ay;let d=20;if(s)try{c.addImage(s,"PNG",150,10,40,20)}catch(l){console.error("Error adding logo:",l)}c.setFontSize(18),c.text("Inspection Report",20,d),d+=15,c.setFontSize(12),c.text(`Inspector: ${t.inspector||"N/A"}`,20,d),c.text(`Inspection Date: ${t.inspection_date||"N/A"}`,20,d+7),c.text(`Equipment: ${t.equipment_id||"N/A"}`,20,d+14),d+=24;try{const e=await window.api.secureOperation("inspectionItems.getByInspectionId",{inspectionId:t.id}),o=e.filter(t=>"fail"===t.result);if(i){const t=o.reduce((t,e)=>{const i=e.priority||"Minor";return t[i]=(t[i]||0)+1,t},{});c.setFontSize(14),c.text("Summary",20,d),d+=7,c.setFontSize(12),c.text(`Total Items Inspected: ${e.length}`,20,d),d+=6,c.text(`Total Deficiencies: ${o.length}`,20,d),d+=6,Object.entries(t).forEach(t=>{let[e,i]=t;c.text(`${e}: ${i}`,25,d),d+=6}),d+=4}n&&(c.setFontSize(14),c.text("Deficiency Details",20,d),d+=7,c.setFontSize(11),0===o.length?(c.text("No deficiencies found.",20,d),d+=7):o.forEach(t=>{if(d>270&&(c.addPage(),d=20),c.text(`Item: ${t.item_text||"N/A"}`,20,d),d+=5,t.standard_ref&&(c.text(`Standard: ${t.standard_ref}`,25,d),d+=5),t.component&&(c.text(`Component: ${t.component}`,25,d),d+=5),t.priority&&(c.text(`Priority: ${t.priority}`,25,d),d+=5),t.notes&&(c.text(`Notes: ${t.notes}`,25,d),d+=5),t.photos){let e=[];try{e=JSON.parse(t.photos)}catch(l){"string"===typeof t.photos&&t.photos.length>0&&(e=[t.photos])}e.length>0&&(c.text("Photos:",25,d),d+=5,e.forEach(t=>{d>250&&(c.addPage(),d=20);try{const e=t.dataUrl||t;if("string"===typeof e&&e.startsWith("data:image/")){const t=e.includes("data:image/png")?"PNG":"JPEG";c.addImage(e,t,30,d,30,20),d+=22}else c.text("[Photo format not supported]",30,d),d+=6}catch(l){c.text("[Photo could not be loaded]",30,d),d+=6}}))}d+=4}))}catch(x){console.error("Error getting inspection items, falling back to legacy data:",x);let e=[];try{e=JSON.parse(t.findings||"[]")}catch(l){e=[]}const o=e.flatMap(t=>t.items||[]).filter(t=>"fail"===t.result);if(i){const t=o.reduce((t,e)=>(t[e.priority]=(t[e.priority]||0)+1,t),{});c.setFontSize(14),c.text("Summary",20,d),d+=7,c.setFontSize(12),c.text(`Total Deficiencies: ${o.length}`,20,d),d+=6,Object.entries(t).forEach(t=>{let[e,i]=t;c.text(`${e}: ${i}`,25,d),d+=6}),d+=4}n&&(c.setFontSize(14),c.text("Deficiency Details",20,d),d+=7,c.setFontSize(11),0===o.length?(c.text("No deficiencies found.",20,d),d+=7):o.forEach(t=>{d>270&&(c.addPage(),d=20),c.text(`Item: ${t.text}`,20,d),d+=5,c.text(`Component: ${t.component}`,25,d),d+=5,c.text(`Priority: ${t.priority}`,25,d),d+=5,c.text(`Notes: ${t.notes}`,25,d),d+=5,t.photos&&t.photos.length>0&&(c.text("Photos:",25,d),d+=5,t.photos.forEach(t=>{d>250&&(c.addPage(),d=20);try{const e=t.dataUrl||t;if("string"===typeof e&&e.startsWith("data:image/")){const t=e.includes("data:image/png")?"PNG":"JPEG";c.addImage(e,t,30,d,30,20),d+=22}else c.text("[Photo format not supported]",30,d),d+=6}catch(l){c.text("[Photo could not be loaded]",30,d),d+=6}})),d+=4}))}if(a&&(d+=4,c.setFontSize(14),c.text("Summary Comments",20,d),d+=7,c.setFontSize(11),c.text(t.summary_comments||"",20,d,{maxWidth:170}),d+=14),r&&(c.setFontSize(14),c.text("Inspector Signature",20,d),d+=7,t.signature))try{c.addImage(t.signature,"PNG",20,d,60,20)}catch(l){c.text("[Signature could not be loaded]",20,d)}c.save(`inspection_${t.id||"report"}_report.pdf`)},s=async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{includeHistory:i=!0,includeDeficiencies:n=!0,logo:a}=e,r=new o.Ay;let s=20;if(a)try{r.addImage(a,"PNG",150,10,40,20)}catch(c){console.error("Error adding logo:",c)}if(r.setFontSize(18),r.text("Work Order Report",20,s),s+=15,r.setFontSize(12),r.text(`WO Number: ${t.wo_number||"N/A"}`,20,s),s+=7,r.text(`Title: ${t.title||"N/A"}`,20,s),s+=7,r.text(`Equipment: ${t.equipment_identifier||t.equipment_id||"N/A"}`,20,s),s+=7,r.text(`Work Type: ${t.work_type||"N/A"}`,20,s),s+=7,r.text(`Priority: ${t.priority||"N/A"}`,20,s),s+=7,r.text(`Status: ${t.status||"N/A"}`,20,s),s+=7,r.text(`Assigned To: ${t.assigned_to||"N/A"}`,20,s),s+=7,r.text(`Created By: ${t.created_by||"N/A"}`,20,s),s+=7,r.text(`Created Date: ${t.created_at||"N/A"}`,20,s),s+=10,t.description&&(r.setFontSize(14),r.text("Description",20,s),s+=7,r.setFontSize(11),r.text(t.description,20,s,{maxWidth:170}),s+=14),(t.estimated_hours||t.actual_hours||t.parts_cost||t.labor_cost)&&(r.setFontSize(14),r.text("Time and Cost",20,s),s+=7,r.setFontSize(11),t.estimated_hours&&(r.text(`Estimated Hours: ${t.estimated_hours}`,20,s),s+=6),t.actual_hours&&(r.text(`Actual Hours: ${t.actual_hours}`,20,s),s+=6),t.parts_cost&&(r.text(`Parts Cost: $${t.parts_cost}`,20,s),s+=6),t.labor_cost&&(r.text(`Labor Cost: $${t.labor_cost}`,20,s),s+=6),s+=4),t.completion_notes&&(r.setFontSize(14),r.text("Completion Notes",20,s),s+=7,r.setFontSize(11),r.text(t.completion_notes,20,s,{maxWidth:170}),s+=14),n&&t.deficiency_id)try{const e=(await window.api.secureOperation("deficiencies.getByEquipmentId",{equipmentId:t.equipment_id})).find(e=>e.id===t.deficiency_id);e&&(s>250&&(r.addPage(),s=20),r.setFontSize(14),r.text("Related Deficiency",20,s),s+=7,r.setFontSize(11),r.text(`Severity: ${e.severity}`,20,s),s+=6,r.text(`Description: ${e.description}`,20,s,{maxWidth:170}),s+=10)}catch(d){console.error("Error loading related deficiency:",d)}r.save(`work_order_${t.wo_number||t.id}_report.pdf`)},c=async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{includeWorkOrders:i=!0,logo:n}=e,a=new o.Ay;let r=20;if(n)try{a.addImage(n,"PNG",150,10,40,20)}catch(s){console.error("Error adding logo:",s)}if(a.setFontSize(18),a.text("Deficiency Report",20,r),r+=15,a.setFontSize(12),a.text(`Equipment: ${t.equipment_identifier||t.equipment_id||"N/A"}`,20,r),r+=7,a.text(`Severity: ${t.severity||"N/A"}`,20,r),r+=7,a.text(`Status: ${t.status||"N/A"}`,20,r),r+=7,a.text(`Component: ${t.component||"N/A"}`,20,r),r+=7,a.text("Remove from Service: "+(t.remove_from_service?"Yes":"No"),20,r),r+=7,a.text(`Due Date: ${t.due_date||"N/A"}`,20,r),r+=7,a.text(`Created: ${t.created_at||"N/A"}`,20,r),r+=10,a.setFontSize(14),a.text("Description",20,r),r+=7,a.setFontSize(11),a.text(t.description||"N/A",20,r,{maxWidth:170}),r+=14,t.corrective_action&&(a.setFontSize(14),a.text("Corrective Action",20,r),r+=7,a.setFontSize(11),a.text(t.corrective_action,20,r,{maxWidth:170}),r+=14),i&&t.work_order_id)try{const e=(await window.api.secureOperation("workOrders.getByEquipmentId",{equipmentId:t.equipment_id})).find(e=>e.id===t.work_order_id);e&&(r>250&&(a.addPage(),r=20),a.setFontSize(14),a.text("Related Work Order",20,r),r+=7,a.setFontSize(11),a.text(`WO Number: ${e.wo_number}`,20,r),r+=6,a.text(`Status: ${e.status}`,20,r),r+=6,a.text(`Title: ${e.title}`,20,r,{maxWidth:170}),r+=10)}catch(c){console.error("Error loading related work order:",c)}a.save(`deficiency_${t.id}_report.pdf`)},d=async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{includeOverdue:i=!0,includeCritical:n=!0,logo:a}=e,r=new o.Ay;let s=20;if(a)try{r.addImage(a,"PNG",150,10,40,20)}catch(c){console.error("Error adding logo:",c)}r.setFontSize(18),r.text("Compliance Summary Report",20,s),s+=10,r.setFontSize(12),r.text(`Generated: ${(new Date).toLocaleDateString()}`,20,s),s+=20,r.setFontSize(14),r.text("Equipment Compliance Status",20,s),s+=10,r.setFontSize(10),r.text("Equipment",20,s),r.text("Type",70,s),r.text("Last Inspection",110,s),r.text("Status",160,s),s+=7,r.line(20,s-2,190,s-2);try{(await window.api.secureOperation("inspections.getComplianceStatus",{})).forEach(t=>{s>270&&(r.addPage(),s=20);const e=t.last_inspection_date||"Never",i=t.last_inspection_date&&new Date(t.last_inspection_date)<new Date(Date.now()-31536e6);let o="OK",n="green";t.critical_failures>0||t.open_critical_deficiencies>0?(o="Critical",n="red"):i&&(o="Overdue",n="orange"),r.text(t.equipment_identifier||"N/A",20,s),r.text(t.type||"N/A",70,s),r.text(e,110,s),r.setTextColor(n),r.text(o,160,s),r.setTextColor("black"),s+=7})}catch(d){console.error("Error loading compliance data:",d),r.text("Error loading compliance data",20,s)}r.save(`compliance_summary_${(new Date).toISOString().split("T")[0]}.pdf`)},l=function(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{logo:n}=i,a=new o.Ay;let r=30;if(n)try{a.addImage(n,"PNG",150,10,40,20)}catch(d){console.error("Error adding logo:",d)}a.setFontSize(20),a.text("LOAD TEST CERTIFICATE",105,r,{align:"center"}),r+=20,a.setFontSize(12),a.text(`Certificate No: ${t.certificate_number||"N/A"}`,105,r,{align:"center"}),r+=20,a.setFontSize(14),a.text("EQUIPMENT INFORMATION",20,r),r+=10,a.setFontSize(11),a.text(`Equipment ID: ${e.equipment_id||"N/A"}`,20,r),r+=7,a.text(`Type: ${e.type||"N/A"}`,20,r),r+=7,a.text(`Manufacturer: ${e.manufacturer||"N/A"}`,20,r),r+=7,a.text(`Model: ${e.model||"N/A"}`,20,r),r+=7,a.text(`Serial Number: ${e.serial_number||"N/A"}`,20,r),r+=7,a.text(`Location: ${e.location||"N/A"}`,20,r),r+=15,a.setFontSize(14),a.text("TEST INFORMATION",20,r),r+=10,a.setFontSize(11),a.text(`Test Date: ${t.test_date||"N/A"}`,20,r),r+=7,a.text(`Test Type: ${t.test_type||"N/A"}`,20,r),r+=7,a.text(`Rated Capacity: ${t.rated_capacity||"N/A"} lbs`,20,r),r+=7,a.text(`Test Load: ${t.test_load||"N/A"} lbs (${t.test_load_percentage||"N/A"}%)`,20,r),r+=7,a.text(`Test Duration: ${t.test_duration||"N/A"} minutes`,20,r),r+=7,a.text(`Inspector: ${t.inspector||"N/A"}`,20,r),r+=15,a.setFontSize(14),a.text("TEST RESULTS",20,r),r+=10,a.setFontSize(11);const s=t.test_results||"N/A";a.setTextColor("pass"===s?"green":"red"),a.text(`Result: ${s.toUpperCase()}`,20,r),a.setTextColor("black"),r+=10,t.deficiencies_found&&(a.text("Deficiencies Found:",20,r),r+=7,a.text(t.deficiencies_found,25,r,{maxWidth:160}),r+=14),t.corrective_actions&&(a.text("Corrective Actions:",20,r),r+=7,a.text(t.corrective_actions,25,r,{maxWidth:160}),r+=14),t.next_test_due&&(a.text(`Next Test Due: ${t.next_test_due}`,20,r),r+=15),r+=10,a.setFontSize(12),a.text("CERTIFICATION",105,r,{align:"center"}),r+=10,a.setFontSize(10);const c=`This certifies that the above equipment has been load tested in accordance with applicable standards and regulations. The test was conducted by a qualified inspector and the equipment ${"pass"===s?"PASSED":"FAILED"} the required test.`;a.text(c,20,r,{maxWidth:170,align:"justify"}),r+=25,a.line(20,r,100,r),r+=7,a.text("Inspector Signature",20,r),a.text(`Date: ${t.test_date||""}`,120,r),a.save(`load_test_certificate_${t.certificate_number||t.id}.pdf`)},x=function(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{logo:n}=i,a=new o.Ay;let r=30;if(n)try{a.addImage(n,"PNG",150,10,40,20)}catch(d){console.error("Error adding logo:",d)}a.setFontSize(20),a.text("CALIBRATION CERTIFICATE",105,r,{align:"center"}),r+=20,a.setFontSize(12),a.text(`Certificate No: ${t.certificate_number||"N/A"}`,105,r,{align:"center"}),r+=20,a.setFontSize(14),a.text("INSTRUMENT INFORMATION",20,r),r+=10,a.setFontSize(11),a.text(`Equipment ID: ${e.equipment_id||"N/A"}`,20,r),r+=7,a.text(`Instrument Type: ${t.instrument_type||"N/A"}`,20,r),r+=7,a.text(`Manufacturer: ${e.manufacturer||"N/A"}`,20,r),r+=7,a.text(`Model: ${e.model||"N/A"}`,20,r),r+=7,a.text(`Serial Number: ${e.serial_number||"N/A"}`,20,r),r+=15,a.setFontSize(14),a.text("CALIBRATION INFORMATION",20,r),r+=10,a.setFontSize(11),a.text(`Calibration Date: ${t.calibration_date||"N/A"}`,20,r),r+=7,a.text(`Due Date: ${t.calibration_due_date||"N/A"}`,20,r),r+=7,a.text(`Calibrated By: ${t.calibrated_by||"N/A"}`,20,r),r+=7,a.text(`Calibration Agency: ${t.calibration_agency||"N/A"}`,20,r),r+=15,a.setFontSize(14),a.text("CALIBRATION RESULTS",20,r),r+=10,a.setFontSize(11);const s=t.calibration_results||"N/A";a.setTextColor("pass"===s?"green":"fail"===s?"red":"orange"),a.text(`Result: ${s.toUpperCase()}`,20,r),a.setTextColor("black"),r+=10,t.accuracy_tolerance&&(a.text(`Required Tolerance: ${t.accuracy_tolerance}`,20,r),r+=7),t.actual_accuracy&&(a.text(`Actual Accuracy: ${t.actual_accuracy}`,20,r),r+=7),t.adjustments_made&&(a.text("Adjustments Made:",20,r),r+=7,a.text(t.adjustments_made,25,r,{maxWidth:160}),r+=14),t.notes&&(a.text("Notes:",20,r),r+=7,a.text(t.notes,25,r,{maxWidth:160}),r+=15),r+=10,a.setFontSize(12),a.text("CERTIFICATION",105,r,{align:"center"}),r+=10,a.setFontSize(10);const c=`This certifies that the above instrument has been calibrated using traceable standards and procedures. The calibration was performed by qualified personnel and the instrument ${"pass"===s?"MEETS":"fail"===s?"DOES NOT MEET":"MEETS WITH LIMITATIONS"} the required accuracy specifications.`;a.text(c,20,r,{maxWidth:170,align:"justify"}),r+=25,a.line(20,r,100,r),r+=7,a.text("Calibration Technician",20,r),a.text(`Date: ${t.calibration_date||""}`,120,r),a.save(`calibration_certificate_${t.certificate_number||t.id}.pdf`)}}}]);
//# sourceMappingURL=953.0ae6a0f0.chunk.js.map