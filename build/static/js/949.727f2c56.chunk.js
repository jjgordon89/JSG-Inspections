"use strict";(self.webpackChunkjsg_inspections=self.webpackChunkjsg_inspections||[]).push([[949],{949:(e,s,t)=>{t.r(s),t.d(s,{default:()=>a});var n=t(5043),i=t(579);const a=function(){const[e,s]=(0,n.useState)([]),[t,a]=(0,n.useState)([]),[c,d]=(0,n.useState)(""),[l,r]=(0,n.useState)(""),[o,u]=(0,n.useState)(""),[p,h]=(0,n.useState)(null);(0,n.useEffect)(()=>{m(),g()},[]);const m=async()=>{try{const e=await window.api.all("SELECT * FROM scheduled_inspections ORDER BY scheduled_date");s(e)}catch(e){console.error("Error fetching scheduled inspections:",e)}},g=async()=>{try{const e=await window.api.all("SELECT * FROM equipment");a(e)}catch(e){console.error("Error fetching equipment:",e)}},E=()=>{d(""),r(""),u(""),h(null)},j=async(e,s)=>{try{await window.api.run("UPDATE scheduled_inspections SET status = ? WHERE id = ?",[s,e]),m()}catch(t){console.error("Error updating inspection status:",t),alert("Failed to update inspection status. Please try again.")}},x=e=>{switch(e){case"scheduled":return"#007bff";case"in_progress":return"#ffc107";case"completed":return"#28a745";default:return"#6c757d"}};return(0,i.jsxs)("div",{className:"scheduler",children:[(0,i.jsx)("h2",{children:"Inspection Scheduler"}),(0,i.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),console.log("Form submitted with:",{selectedEquipment:c,scheduledDate:l,assignedInspector:o}),!c||!l)return console.log("Validation failed:",{selectedEquipment:c,scheduledDate:l}),void alert("Please select equipment and a date.");console.log("Validation passed, proceeding with API call");try{p?await window.api.run("UPDATE scheduled_inspections SET equipment_id = ?, scheduled_date = ?, assigned_inspector = ? WHERE id = ?",[parseInt(c),l,o,p.id]):await window.api.run("INSERT INTO scheduled_inspections (equipment_id, scheduled_date, assigned_inspector, status, equipmentIdentifier) VALUES (?, ?, ?, ?, ?)",[parseInt(c),l,o,"scheduled",`EQ-${c.toString().padStart(3,"0")}`]),m(),E()}catch(s){console.error("Error saving scheduled inspection:",s),alert("Failed to save scheduled inspection. Please try again.")}},className:"scheduler-form",children:[(0,i.jsxs)("select",{value:c,onChange:e=>d(e.target.value),required:!0,children:[(0,i.jsx)("option",{value:"",children:"Select Equipment"}),t.map(e=>(0,i.jsxs)("option",{value:e.id,children:[e.equipment_id," - ",e.type]},e.id))]}),(0,i.jsx)("input",{type:"date",value:l,onChange:e=>r(e.target.value),required:!0}),(0,i.jsx)("input",{type:"text",placeholder:"Assigned Inspector",value:o,onChange:e=>u(e.target.value)}),(0,i.jsx)("button",{type:"submit",children:p?"Update Inspection":"Schedule Inspection"}),p&&(0,i.jsx)("button",{type:"button",onClick:E,children:"Cancel Edit"})]}),(0,i.jsxs)("div",{className:"scheduled-inspections-list",children:[(0,i.jsx)("h3",{children:"Scheduled Inspections"}),0===e.length?(0,i.jsx)("p",{children:"No scheduled inspections found."}):(0,i.jsx)("div",{className:"inspections-grid",children:e.map(e=>(0,i.jsxs)("div",{className:"inspection-card",children:[(0,i.jsxs)("div",{className:"inspection-header",children:[(0,i.jsxs)("h4",{children:["Equipment: ",e.equipmentIdentifier]}),(0,i.jsx)("span",{className:"status-badge",style:{backgroundColor:x(e.status)},children:e.status.replace("_"," ").toUpperCase()})]}),(0,i.jsxs)("div",{className:"inspection-details",children:[(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Date:"})," ",new Date(e.scheduled_date).toLocaleDateString()]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Inspector:"})," ",e.assigned_inspector||"Unassigned"]})]}),(0,i.jsxs)("div",{className:"inspection-actions",children:["scheduled"===e.status&&(0,i.jsx)("button",{onClick:()=>(e=>{j(e.id,"in_progress")})(e),className:"start-btn",children:"Start Inspection"}),"in_progress"===e.status&&(0,i.jsx)("button",{onClick:()=>j(e.id,"completed"),className:"complete-btn",children:"Mark Complete"}),(0,i.jsx)("button",{onClick:()=>(e=>{h(e),d(e.equipment_id),r(e.scheduled_date),u(e.assigned_inspector)})(e),className:"edit-btn",children:"Edit"}),(0,i.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this scheduled inspection?"))try{await window.api.run("DELETE FROM scheduled_inspections WHERE id = ?",[e]),m()}catch(s){console.error("Error deleting scheduled inspection:",s),alert("Failed to delete scheduled inspection. Please try again.")}})(e.id),className:"delete-btn",children:"Delete"})]})]},e.id))})]})]})}}}]);
//# sourceMappingURL=949.727f2c56.chunk.js.map