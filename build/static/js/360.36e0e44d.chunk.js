"use strict";(self.webpackChunkjsg_inspections=self.webpackChunkjsg_inspections||[]).push([[25,360],{3360:(e,s,t)=>{t.r(s),t.d(s,{default:()=>m});var a=t(5043),i=t(7304),r=t(7690),c=t(3400);const n=new class{constructor(){this.cache=new Map,this.cacheTimestamps=new Map,this.defaultTTL=3e5,this.maxCacheSize=100,this.ttlConfig={"equipment.getAll":6e5,"equipment.getStatusCounts":3e5,"equipment.getDistinctTypes":18e5,"inspections.getCount":12e4,"inspections.getPerMonth":6e5,"inspections.getComplianceStatus":3e5,"inspections.getOverdue":3e5,"scheduledInspections.getUpcoming":3e5,"loadTests.getTotal":6e5,"loadTests.getOverdue":3e5,"calibrations.getTotal":6e5,"calibrations.getOverdue":3e5,"certificates.getTotal":6e5,"credentials.getTotal":6e5,"credentials.getExpiring":3e5},this.invalidationRules={"equipment.create":["equipment.getAll","equipment.getStatusCounts","equipment.getDistinctTypes"],"equipment.update":["equipment.getAll","equipment.getStatusCounts"],"equipment.delete":["equipment.getAll","equipment.getStatusCounts"],"inspections.create":["inspections.getCount","inspections.getPerMonth","inspections.getComplianceStatus"],"inspections.createFromScheduled":["inspections.getCount","inspections.getPerMonth","inspections.getComplianceStatus"],"scheduledInspections.create":["scheduledInspections.getUpcoming"],"scheduledInspections.update":["scheduledInspections.getUpcoming"],"scheduledInspections.delete":["scheduledInspections.getUpcoming"],"loadTests.create":["loadTests.getTotal"],"calibrations.create":["calibrations.getTotal"],"credentials.create":["credentials.getTotal"],"credentials.updateStatus":["credentials.getTotal","credentials.getExpiring"]}}_generateKey(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=`${e}.${s}`;if(0===Object.keys(t).length)return a;return`${a}:${Object.keys(t).sort().map(e=>`${e}:${JSON.stringify(t[e])}`).join("|")}`}_isValid(e){if(!this.cache.has(e)||!this.cacheTimestamps.has(e))return!1;const s=this.cacheTimestamps.get(e),t=e.split(":")[0],a=this.ttlConfig[t]||this.defaultTTL;return Date.now()-s<a}_cleanup(){const e=Date.now(),s=[];for(const[t,a]of this.cacheTimestamps.entries()){const i=t.split(":")[0];e-a>=(this.ttlConfig[i]||this.defaultTTL)&&s.push(t)}s.forEach(e=>{this.cache.delete(e),this.cacheTimestamps.delete(e)})}_enforceSizeLimit(){if(this.cache.size<=this.maxCacheSize)return;Array.from(this.cacheTimestamps.entries()).sort((e,s)=>e[1]-s[1]).slice(0,this.cache.size-this.maxCacheSize).forEach(e=>{let[s]=e;this.cache.delete(s),this.cacheTimestamps.delete(s)})}get(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=this._generateKey(e,s,t);return this._isValid(a)?(this.cacheTimestamps.set(a,Date.now()),this.cache.get(a)):null}set(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3?arguments[3]:void 0;const i=this._generateKey(e,s,t);this.cache.set(i,a),this.cacheTimestamps.set(i,Date.now()),this._enforceSizeLimit(),Math.random()<.1&&this._cleanup()}invalidate(e,s){const t=`${e}.${s}`;[t,...this.invalidationRules[t]||[]].forEach(e=>{const s=[];for(const t of this.cache.keys())t.startsWith(e)&&s.push(t);s.forEach(e=>{this.cache.delete(e),this.cacheTimestamps.delete(e)})})}clear(){this.cache.clear(),this.cacheTimestamps.clear()}getStats(){return{size:this.cache.size,maxSize:this.maxCacheSize,hitRate:this.hitCount/(this.hitCount+this.missCount)||0,entries:Array.from(this.cache.keys())}}async warmUp(e){const s=[{category:"equipment",operation:"getAll"},{category:"equipment",operation:"getStatusCounts"},{category:"equipment",operation:"getDistinctTypes"},{category:"inspections",operation:"getCount"},{category:"loadTests",operation:"getTotal"},{category:"calibrations",operation:"getTotal"},{category:"certificates",operation:"getTotal"},{category:"credentials",operation:"getTotal"}].map(async s=>{let{category:t,operation:a}=s;try{const s=await e(t,a,{});this.set(t,a,{},s)}catch(i){console.warn(`Cache warm-up failed for ${t}.${a}:`,i)}});await Promise.allSettled(s)}},l=async function(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=`${e}.${s}`;if(!(Object.keys(n.ttlConfig).includes(a)||s.startsWith("get")))return["create","update","delete"].some(e=>s.includes(e))&&n.invalidate(e,s),await window.api.secureOperation(e,s,t);const i=n.get(e,s,t);if(null!==i)return i;try{const a=await window.api.secureOperation(e,s,t);return n.set(e,s,t,a),a}catch(r){throw console.error(`Cached operation failed for ${e}.${s}:`,r),r}};var o=t(6025),d=t(579);i.t1.register(i.PP,i.kc,i.E8,i.hE,i.m_,i.s$,i.Bs);const m=()=>{const{darkMode:e}=(0,r.j_)(),{refresh:s}=(0,r.r9)(),{viewingInspectionsFor:t}=(0,r.bc)(),[i,n]=(0,a.useState)({equipment:{total:0,active:0,outOfService:0,taggedOut:0},inspections:{total:0,thisMonth:0,overdue:0,upcoming:0},workOrders:{total:0,open:0,inProgress:0,overdue:0},deficiencies:{total:0,critical:0,overdue:0},pmSchedules:{total:0,due:0,overdue:0},loadTests:{total:0,due:0,overdue:0},calibrations:{total:0,due:0,overdue:0},certificates:{total:0,expiring:0},credentials:{total:0,expiring:0}}),[m,h]=(0,a.useState)(!0),[u,p]=(0,a.useState)(null),[x,g]=(0,a.useState)("30"),[j,v]=(0,a.useState)(!1),{metrics:N}=(0,c.eu)("Dashboard");(0,a.useEffect)(()=>{y()},[x]);const y=async()=>{try{var e;h(!0),p(null);const s=(new Date).toISOString().split("T")[0],t=new Date;t.setDate(t.getDate()+parseInt(x));const a=t.toISOString().split("T")[0],i=[()=>l("equipment","getAll"),()=>l("equipment","getStatusCounts"),()=>l("inspections","getCount"),()=>l("inspections","getPerMonth"),()=>l("inspections","getOverdue"),()=>l("scheduledInspections","getUpcoming",s),()=>l("workOrders","getAll"),()=>l("workOrders","getDueToday"),()=>l("workOrders","getOverdue"),()=>l("deficiencies","getAll"),()=>l("deficiencies","getOpenCritical"),()=>l("deficiencies","getOverdue"),()=>l("pmSchedules","getTotal"),()=>l("pmSchedules","getDue",a),()=>l("pmSchedules","getOverdue"),()=>l("loadTests","getTotal"),()=>l("loadTests","getDue",a),()=>l("loadTests","getOverdue"),()=>l("calibrations","getTotal"),()=>l("calibrations","getDue",a),()=>l("calibrations","getOverdue"),()=>l("certificates","getTotal"),()=>l("certificates","getExpiring",a),()=>l("credentials","getTotal"),()=>l("credentials","getExpiring",a)],[r,o,d,m,u,g,j,v,N,y,b,f,w,S,T,C,A,O,k,M,z,q,L,$,D]=await(0,c.aD)(i,3),R=Array.isArray(o)?o.reduce((e,s)=>(s&&s.status&&"number"===typeof s.count&&(e[s.status]=s.count),e),{}):{},E=(new Date).toISOString().substring(0,7),P=Array.isArray(m)&&(null===(e=m.find(e=>e&&e.month===E))||void 0===e?void 0:e.count)||0,I=Array.isArray(j)?j.reduce((e,s)=>(s&&s.status&&(e[s.status]=(e[s.status]||0)+1),e),{}):{};n({equipment:{total:Array.isArray(r)?r.length:0,active:R.active||0,outOfService:R.out_of_service||0,taggedOut:Array.isArray(r)?r.filter(e=>e&&e.tagged_out).length:0},inspections:{total:"number"===typeof d?d:0,thisMonth:P,overdue:Array.isArray(u)?u.length:0,upcoming:Array.isArray(g)?g.length:0},workOrders:{total:Array.isArray(j)?j.length:0,open:(I.draft||0)+(I.approved||0)+(I.assigned||0),inProgress:I.in_progress||0,overdue:Array.isArray(N)?N.length:0},deficiencies:{total:Array.isArray(y)?y.length:0,critical:Array.isArray(b)?b.length:0,overdue:Array.isArray(f)?f.length:0},pmSchedules:{total:"number"===typeof w?w:0,due:Array.isArray(S)?S.length:0,overdue:Array.isArray(T)?T.length:0},loadTests:{total:"number"===typeof C?C:0,due:Array.isArray(A)?A.length:0,overdue:Array.isArray(O)?O.length:0},calibrations:{total:"number"===typeof k?k:0,due:Array.isArray(M)?M.length:0,overdue:Array.isArray(z)?z.length:0},certificates:{total:"number"===typeof q?q:0,expiring:Array.isArray(L)?L.length:0},credentials:{total:"number"===typeof $?$:0,expiring:Array.isArray(D)?D.length:0}})}catch(s){console.error("Error loading dashboard data:",s),p(s.message)}finally{h(!1)}},b=(e,s,t)=>"critical"===e&&s>0?"status-critical":"overdue"===e&&s>0?"status-overdue":"due"===e&&s>0||"expiring"===e&&s>0?"status-warning":"status-good";return m?(0,d.jsxs)("div",{className:"dashboard",children:[(0,d.jsx)("div",{className:"dashboard-header",children:(0,d.jsx)("h1",{children:"CMMS Dashboard"})}),(0,d.jsx)("div",{className:"loading-spinner",children:"Loading dashboard data..."})]}):u?(0,d.jsxs)("div",{className:"dashboard",children:[(0,d.jsx)("div",{className:"dashboard-header",children:(0,d.jsx)("h1",{children:"CMMS Dashboard"})}),(0,d.jsxs)("div",{className:"error-message",children:[(0,d.jsxs)("p",{children:["Error loading dashboard: ",u]}),(0,d.jsx)("button",{onClick:y,className:"retry-button",children:"Retry"})]})]}):(0,d.jsxs)("div",{className:"dashboard",children:[(0,d.jsxs)("div",{className:"dashboard-header",children:[(0,d.jsx)("h1",{children:"CMMS Dashboard"}),(0,d.jsxs)("div",{className:"timeframe-selector",children:[(0,d.jsx)("label",{children:"Forecast Period:"}),(0,d.jsxs)("select",{value:x,onChange:e=>g(e.target.value),children:[(0,d.jsx)("option",{value:"7",children:"7 Days"}),(0,d.jsx)("option",{value:"30",children:"30 Days"}),(0,d.jsx)("option",{value:"60",children:"60 Days"}),(0,d.jsx)("option",{value:"90",children:"90 Days"})]}),(0,d.jsx)("button",{onClick:()=>v(!0),className:"performance-monitor-btn",title:"Open Performance Monitor",children:"\ud83d\udcca Performance"})]})]}),(0,d.jsxs)("div",{className:"dashboard-grid",children:[(0,d.jsxs)("div",{className:"dashboard-card",children:[(0,d.jsx)("h3",{children:"Equipment Status"}),(0,d.jsxs)("div",{className:"metrics-grid",children:[(0,d.jsxs)("div",{className:"metric",children:[(0,d.jsx)("span",{className:"metric-value",children:i.equipment.total}),(0,d.jsx)("span",{className:"metric-label",children:"Total Assets"})]}),(0,d.jsxs)("div",{className:"metric",children:[(0,d.jsx)("span",{className:"metric-value status-good",children:i.equipment.active}),(0,d.jsx)("span",{className:"metric-label",children:"Active"})]}),(0,d.jsxs)("div",{className:"metric",children:[(0,d.jsx)("span",{className:`metric-value ${b("critical",i.equipment.outOfService)}`,children:i.equipment.outOfService}),(0,d.jsx)("span",{className:"metric-label",children:"Out of Service"})]}),(0,d.jsxs)("div",{className:"metric",children:[(0,d.jsx)("span",{className:`metric-value ${b("critical",i.equipment.taggedOut)}`,children:i.equipment.taggedOut}),(0,d.jsx)("span",{className:"metric-label",children:"Tagged Out"})]})]})]}),(0,d.jsxs)("div",{className:"dashboard-card",children:[(0,d.jsx)("h3",{children:"Inspections"}),(0,d.jsxs)("div",{className:"metrics-grid",children:[(0,d.jsxs)("div",{className:"metric",children:[(0,d.jsx)("span",{className:"metric-value",children:i.inspections.total}),(0,d.jsx)("span",{className:"metric-label",children:"Total"})]}),(0,d.jsxs)("div",{className:"metric",children:[(0,d.jsx)("span",{className:"metric-value status-good",children:i.inspections.thisMonth}),(0,d.jsx)("span",{className:"metric-label",children:"This Month"})]}),(0,d.jsxs)("div",{className:"metric",children:[(0,d.jsx)("span",{className:`metric-value ${b("due",i.inspections.upcoming)}`,children:i.inspections.upcoming}),(0,d.jsx)("span",{className:"metric-label",children:"Upcoming"})]}),(0,d.jsxs)("div",{className:"metric",children:[(0,d.jsx)("span",{className:`metric-value ${b("overdue",i.inspections.overdue)}`,children:i.inspections.overdue}),(0,d.jsx)("span",{className:"metric-label",children:"Overdue"})]})]})]}),(0,d.jsxs)("div",{className:"dashboard-card",children:[(0,d.jsx)("h3",{children:"Work Orders"}),(0,d.jsxs)("div",{className:"metrics-grid",children:[(0,d.jsxs)("div",{className:"metric",children:[(0,d.jsx)("span",{className:"metric-value",children:i.workOrders.total}),(0,d.jsx)("span",{className:"metric-label",children:"Total"})]}),(0,d.jsxs)("div",{className:"metric",children:[(0,d.jsx)("span",{className:"metric-value status-warning",children:i.workOrders.open}),(0,d.jsx)("span",{className:"metric-label",children:"Open"})]}),(0,d.jsxs)("div",{className:"metric",children:[(0,d.jsx)("span",{className:"metric-value status-good",children:i.workOrders.inProgress}),(0,d.jsx)("span",{className:"metric-label",children:"In Progress"})]}),(0,d.jsxs)("div",{className:"metric",children:[(0,d.jsx)("span",{className:`metric-value ${b("overdue",i.workOrders.overdue)}`,children:i.workOrders.overdue}),(0,d.jsx)("span",{className:"metric-label",children:"Overdue"})]})]})]}),(0,d.jsxs)("div",{className:"dashboard-card",children:[(0,d.jsx)("h3",{children:"Deficiencies"}),(0,d.jsxs)("div",{className:"metrics-grid",children:[(0,d.jsxs)("div",{className:"metric",children:[(0,d.jsx)("span",{className:"metric-value",children:i.deficiencies.total}),(0,d.jsx)("span",{className:"metric-label",children:"Total"})]}),(0,d.jsxs)("div",{className:"metric",children:[(0,d.jsx)("span",{className:`metric-value ${b("critical",i.deficiencies.critical)}`,children:i.deficiencies.critical}),(0,d.jsx)("span",{className:"metric-label",children:"Critical Open"})]}),(0,d.jsxs)("div",{className:"metric",children:[(0,d.jsx)("span",{className:`metric-value ${b("overdue",i.deficiencies.overdue)}`,children:i.deficiencies.overdue}),(0,d.jsx)("span",{className:"metric-label",children:"Overdue"})]}),(0,d.jsxs)("div",{className:"metric",children:[(0,d.jsx)("span",{className:"metric-value status-good",children:i.deficiencies.total-i.deficiencies.critical-i.deficiencies.overdue}),(0,d.jsx)("span",{className:"metric-label",children:"On Track"})]})]})]}),(0,d.jsxs)("div",{className:"dashboard-card",children:[(0,d.jsx)("h3",{children:"Preventive Maintenance"}),(0,d.jsxs)("div",{className:"metrics-grid",children:[(0,d.jsxs)("div",{className:"metric",children:[(0,d.jsx)("span",{className:"metric-value",children:i.pmSchedules.total}),(0,d.jsx)("span",{className:"metric-label",children:"Total Schedules"})]}),(0,d.jsxs)("div",{className:"metric",children:[(0,d.jsx)("span",{className:`metric-value ${b("due",i.pmSchedules.due)}`,children:i.pmSchedules.due}),(0,d.jsx)("span",{className:"metric-label",children:"Due Soon"})]}),(0,d.jsxs)("div",{className:"metric",children:[(0,d.jsx)("span",{className:`metric-value ${b("overdue",i.pmSchedules.overdue)}`,children:i.pmSchedules.overdue}),(0,d.jsx)("span",{className:"metric-label",children:"Overdue"})]}),(0,d.jsxs)("div",{className:"metric",children:[(0,d.jsx)("span",{className:"metric-value status-good",children:Math.max(0,i.pmSchedules.total-i.pmSchedules.due-i.pmSchedules.overdue)}),(0,d.jsx)("span",{className:"metric-label",children:"Current"})]})]})]}),(0,d.jsxs)("div",{className:"dashboard-card",children:[(0,d.jsx)("h3",{children:"Crane Compliance"}),(0,d.jsxs)("div",{className:"metrics-grid",children:[(0,d.jsxs)("div",{className:"metric",children:[(0,d.jsx)("span",{className:`metric-value ${b("due",i.loadTests.due)}`,children:i.loadTests.due}),(0,d.jsx)("span",{className:"metric-label",children:"Load Tests Due"})]}),(0,d.jsxs)("div",{className:"metric",children:[(0,d.jsx)("span",{className:`metric-value ${b("due",i.calibrations.due)}`,children:i.calibrations.due}),(0,d.jsx)("span",{className:"metric-label",children:"Calibrations Due"})]}),(0,d.jsxs)("div",{className:"metric",children:[(0,d.jsx)("span",{className:`metric-value ${b("expiring",i.certificates.expiring)}`,children:i.certificates.expiring}),(0,d.jsx)("span",{className:"metric-label",children:"Certificates Expiring"})]}),(0,d.jsxs)("div",{className:"metric",children:[(0,d.jsx)("span",{className:`metric-value ${b("expiring",i.credentials.expiring)}`,children:i.credentials.expiring}),(0,d.jsx)("span",{className:"metric-label",children:"Credentials Expiring"})]})]})]}),(0,d.jsxs)("div",{className:"dashboard-card quick-actions",children:[(0,d.jsx)("h3",{children:"Quick Actions"}),(0,d.jsxs)("div",{className:"action-buttons",children:[(0,d.jsx)("button",{className:"action-button primary",onClick:()=>window.location.hash="#/scheduler",children:"\ud83d\udcc5 Schedule Inspection"}),(0,d.jsx)("button",{className:"action-button secondary",onClick:()=>window.location.hash="#/work-orders",children:"\ud83d\udd27 Create Work Order"}),(0,d.jsx)("button",{className:"action-button secondary",onClick:()=>window.location.hash="#/deficiencies",children:"\u26a0\ufe0f View Deficiencies"}),(0,d.jsx)("button",{className:"action-button secondary",onClick:()=>window.location.hash="#/compliance",children:"\ud83d\udccb Compliance Report"})]})]}),(0,d.jsxs)("div",{className:"dashboard-card recent-activity",children:[(0,d.jsx)("h3",{children:"Recent Activity"}),(0,d.jsxs)("div",{className:"activity-list",children:[(0,d.jsxs)("div",{className:"activity-item",children:[(0,d.jsx)("span",{className:"activity-icon",children:"\ud83d\udd0d"}),(0,d.jsx)("span",{className:"activity-text",children:"System ready for P2 feature development"}),(0,d.jsx)("span",{className:"activity-time",children:"Just now"})]}),(0,d.jsxs)("div",{className:"activity-item",children:[(0,d.jsx)("span",{className:"activity-icon",children:"\u2705"}),(0,d.jsx)("span",{className:"activity-text",children:"P2 database migrations completed"}),(0,d.jsx)("span",{className:"activity-time",children:"Just now"})]}),(0,d.jsxs)("div",{className:"activity-item",children:[(0,d.jsx)("span",{className:"activity-icon",children:"\ud83d\udd12"}),(0,d.jsx)("span",{className:"activity-text",children:"All secure operations implemented"}),(0,d.jsx)("span",{className:"activity-time",children:"Just now"})]})]})]}),(0,d.jsxs)("div",{className:"dashboard-card system-health",children:[(0,d.jsx)("h3",{children:"System Health"}),(0,d.jsxs)("div",{className:"health-indicators",children:[(0,d.jsxs)("div",{className:"health-item",children:[(0,d.jsx)("span",{className:"health-label",children:"Database"}),(0,d.jsx)("span",{className:"health-status status-good",children:"\u2705 Healthy"})]}),(0,d.jsxs)("div",{className:"health-item",children:[(0,d.jsx)("span",{className:"health-label",children:"Migrations"}),(0,d.jsx)("span",{className:"health-status status-good",children:"\u2705 v5 Current"})]}),(0,d.jsxs)("div",{className:"health-item",children:[(0,d.jsx)("span",{className:"health-label",children:"Security"}),(0,d.jsx)("span",{className:"health-status status-good",children:"\u2705 Secured"})]}),(0,d.jsxs)("div",{className:"health-item",children:[(0,d.jsx)("span",{className:"health-label",children:"CMMS Features"}),(0,d.jsx)("span",{className:"health-status status-good",children:"\u2705 Active"})]})]})]})]}),(i.deficiencies.critical>0||i.equipment.outOfService>0||i.workOrders.overdue>0||i.loadTests.overdue>0||i.calibrations.overdue>0||i.pmSchedules.overdue>0)&&(0,d.jsxs)("div",{className:"critical-alerts",children:[(0,d.jsx)("h3",{children:"\ud83d\udea8 Critical Alerts"}),(0,d.jsxs)("div",{className:"alert-list",children:[i.deficiencies.critical>0&&(0,d.jsxs)("div",{className:"alert-item critical",children:[(0,d.jsx)("span",{className:"alert-icon",children:"\u26a0\ufe0f"}),(0,d.jsxs)("span",{className:"alert-text",children:[i.deficiencies.critical," critical deficiencies require immediate attention"]}),(0,d.jsx)("button",{className:"alert-action",onClick:()=>window.location.hash="#/deficiencies?filter=critical",children:"View Details"})]}),i.equipment.outOfService>0&&(0,d.jsxs)("div",{className:"alert-item warning",children:[(0,d.jsx)("span",{className:"alert-icon",children:"\ud83d\udd27"}),(0,d.jsxs)("span",{className:"alert-text",children:[i.equipment.outOfService," assets are out of service"]}),(0,d.jsx)("button",{className:"alert-action",onClick:()=>window.location.hash="#/equipment?filter=out_of_service",children:"View Assets"})]}),i.workOrders.overdue>0&&(0,d.jsxs)("div",{className:"alert-item warning",children:[(0,d.jsx)("span",{className:"alert-icon",children:"\ud83d\udccb"}),(0,d.jsxs)("span",{className:"alert-text",children:[i.workOrders.overdue," work orders are overdue"]}),(0,d.jsx)("button",{className:"alert-action",onClick:()=>window.location.hash="#/work-orders?filter=overdue",children:"View Work Orders"})]}),i.loadTests.overdue>0&&(0,d.jsxs)("div",{className:"alert-item critical",children:[(0,d.jsx)("span",{className:"alert-icon",children:"\ud83c\udfd7\ufe0f"}),(0,d.jsxs)("span",{className:"alert-text",children:[i.loadTests.overdue," load tests are overdue - compliance risk!"]}),(0,d.jsx)("button",{className:"alert-action",onClick:()=>window.location.hash="#/load-tests?filter=overdue",children:"View Load Tests"})]}),i.calibrations.overdue>0&&(0,d.jsxs)("div",{className:"alert-item warning",children:[(0,d.jsx)("span",{className:"alert-icon",children:"\ud83d\udccf"}),(0,d.jsxs)("span",{className:"alert-text",children:[i.calibrations.overdue," calibrations are overdue"]}),(0,d.jsx)("button",{className:"alert-action",onClick:()=>window.location.hash="#/calibrations?filter=overdue",children:"View Calibrations"})]}),i.pmSchedules.overdue>0&&(0,d.jsxs)("div",{className:"alert-item warning",children:[(0,d.jsx)("span",{className:"alert-icon",children:"\ud83d\udd27"}),(0,d.jsxs)("span",{className:"alert-text",children:[i.pmSchedules.overdue," preventive maintenance tasks are overdue"]}),(0,d.jsx)("button",{className:"alert-action",onClick:()=>window.location.hash="#/preventive-maintenance?filter=overdue",children:"View PM Schedule"})]})]})]}),(0,d.jsxs)("div",{className:"compliance-summary",children:[(0,d.jsx)("h3",{children:"\ud83d\udcca Compliance Summary"}),(0,d.jsxs)("div",{className:"compliance-grid",children:[(0,d.jsxs)("div",{className:"compliance-item",children:[(0,d.jsxs)("div",{className:"compliance-header",children:[(0,d.jsx)("span",{className:"compliance-title",children:"ASME B30 Compliance"}),(0,d.jsxs)("span",{className:"compliance-percentage",children:[i.equipment.total>0?Math.round((i.equipment.total-i.deficiencies.critical)/i.equipment.total*100):100,"%"]})]}),(0,d.jsx)("div",{className:"compliance-bar",children:(0,d.jsx)("div",{className:"compliance-fill",style:{width:(i.equipment.total>0?(i.equipment.total-i.deficiencies.critical)/i.equipment.total*100:100)+"%"}})})]}),(0,d.jsxs)("div",{className:"compliance-item",children:[(0,d.jsxs)("div",{className:"compliance-header",children:[(0,d.jsx)("span",{className:"compliance-title",children:"OSHA 1910.179 Compliance"}),(0,d.jsxs)("span",{className:"compliance-percentage",children:[i.equipment.total>0?Math.round((i.equipment.total-i.deficiencies.critical)/i.equipment.total*100):100,"%"]})]}),(0,d.jsx)("div",{className:"compliance-bar",children:(0,d.jsx)("div",{className:"compliance-fill",style:{width:(i.equipment.total>0?(i.equipment.total-i.deficiencies.critical)/i.equipment.total*100:100)+"%"}})})]})]})]}),(0,d.jsxs)("div",{className:"dashboard-footer",children:[(0,d.jsxs)("p",{children:["Last updated: ",(new Date).toLocaleString()]}),(0,d.jsx)("p",{children:"JSG Inspections CMMS v2.0 - P2 Implementation Complete"})]}),j&&(0,d.jsx)(o.default,{isOpen:j,onClose:()=>v(!1),metrics:N})]})}},3400:(e,s,t)=>{t.d(s,{EJ:()=>n,F3:()=>c,aD:()=>r,cz:()=>l,eu:()=>i});var a=t(5043);t(579);const i=e=>{a.useEffect(()=>{const s=performance.now();return()=>{const t=performance.now()-s;t>100&&console.warn(`Slow render detected in ${e}: ${t.toFixed(2)}ms`)}})},r=async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;const t=[];for(let a=0;a<e.length;a+=s){const i=e.slice(a,a+s),r=await Promise.all(i);t.push(...r),a+s<e.length&&await new Promise(e=>setTimeout(e,50))}return t},c={analyzeBundleSize(){const e=Array.from(document.querySelectorAll("script[src]")),s=Array.from(document.querySelectorAll('link[rel="stylesheet"]'));return{scripts:e.map(e=>({src:e.src,async:e.async,defer:e.defer})),stylesheets:s.map(e=>({href:e.href,media:e.media})),totalScripts:e.length,totalStylesheets:s.length}},getResourceMetrics(){if(!window.performance||!window.performance.getEntriesByType)return null;const e=window.performance.getEntriesByType("resource"),s=window.performance.getEntriesByType("navigation")[0];return{totalResources:e.length,totalLoadTime:s?s.loadEventEnd-s.fetchStart:0,domContentLoaded:s?s.domContentLoadedEventEnd-s.fetchStart:0,largestResources:e.sort((e,s)=>s.transferSize-e.transferSize).slice(0,10).map(e=>({name:e.name,size:e.transferSize,duration:e.duration,type:e.initiatorType}))}},getOptimizationRecommendations(){const e=[],s=this.getResourceMetrics();if(!s)return["Performance API not available"];const t=s.largestResources.filter(e=>e.size>5e5);return t.length>0&&e.push(`Consider code splitting or lazy loading for ${t.length} large resources`),s.totalLoadTime>3e3&&e.push("Total load time exceeds 3 seconds - consider optimizing critical resources"),s.domContentLoaded>1500&&e.push("DOM content loaded time is slow - optimize critical CSS and JavaScript"),s.totalResources>50&&e.push("High number of resources - consider bundling or HTTP/2 server push"),e.length>0?e:["Bundle performance looks good!"]}},n={getMemoryUsage(){if(!window.performance||!window.performance.memory)return null;const e=window.performance.memory;return{usedJSHeapSize:Math.round(e.usedJSHeapSize/1048576),totalJSHeapSize:Math.round(e.totalJSHeapSize/1048576),jsHeapSizeLimit:Math.round(e.jsHeapSizeLimit/1048576),usage:Math.round(e.usedJSHeapSize/e.jsHeapSizeLimit*100)}},startMonitoring(){let e=arguments.length>1?arguments[1]:void 0;const s=setInterval(()=>{const s=this.getMemoryUsage();s&&e&&e(s)},arguments.length>0&&void 0!==arguments[0]?arguments[0]:5e3);return()=>clearInterval(s)}},l={budgets:{loadTime:3e3,domContentLoaded:1500,maxResourceSize:5e5,maxResources:50,maxMemoryUsage:80},checkBudget(){const e=c.getResourceMetrics(),s=n.getMemoryUsage(),t={};if(e){t.loadTime={actual:e.totalLoadTime,budget:this.budgets.loadTime,passed:e.totalLoadTime<=this.budgets.loadTime},t.domContentLoaded={actual:e.domContentLoaded,budget:this.budgets.domContentLoaded,passed:e.domContentLoaded<=this.budgets.domContentLoaded},t.resourceCount={actual:e.totalResources,budget:this.budgets.maxResources,passed:e.totalResources<=this.budgets.maxResources};const s=e.largestResources.filter(e=>e.size>this.budgets.maxResourceSize);t.resourceSize={actual:s.length,budget:0,passed:0===s.length}}return s&&(t.memoryUsage={actual:s.usage,budget:this.budgets.maxMemoryUsage,passed:s.usage<=this.budgets.maxMemoryUsage}),t}}},6025:(e,s,t)=>{t.r(s),t.d(s,{default:()=>n});var a=t(5043),i=t(3400),r=t(8221),c=t(579);const n=e=>{let{isOpen:s=!1,onClose:t,metrics:n}=e;const l=s,{darkMode:o}=(0,r.A)(),[d,m]=(0,a.useState)({bundle:null,memory:null,budget:null,resources:null}),[h,u]=(0,a.useState)(!1),[p,x]=(0,a.useState)([]);(0,a.useRef)(null);(0,a.useEffect)(()=>{l&&g()},[l]),(0,a.useEffect)(()=>{if(h&&l){const e=setInterval(g,5e3);return()=>clearInterval(e)}},[h,l]);const g=()=>{const e=i.F3.analyzeBundleSize(),s=i.F3.getResourceMetrics(),t={bundle:e,memory:i.EJ.getMemoryUsage(),budget:i.cz.checkBudget(),resources:s,recommendations:i.F3.getOptimizationRecommendations(),timestamp:(new Date).toISOString()};m(t),x(e=>[...e,t].slice(-20))};if(!l)return null;const j=o?"bg-gray-800 text-white border-gray-600":"bg-white text-gray-900 border-gray-300",v=o?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200";return(0,c.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,c.jsxs)("div",{className:`${j} border rounded-lg shadow-xl w-11/12 max-w-6xl max-h-5/6 overflow-hidden`,children:[(0,c.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-300 dark:border-gray-600",children:[(0,c.jsx)("h2",{className:"text-xl font-semibold",children:"Performance Monitor"}),(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,c.jsx)("button",{onClick:()=>{u(!h)},className:"px-3 py-1 rounded text-sm font-medium "+(h?"bg-red-500 hover:bg-red-600 text-white":"bg-green-500 hover:bg-green-600 text-white"),children:h?"Stop Monitoring":"Start Monitoring"}),(0,c.jsx)("button",{onClick:g,className:"px-3 py-1 bg-blue-500 hover:bg-blue-600 text-white rounded text-sm font-medium",children:"Refresh"}),(0,c.jsx)("button",{onClick:()=>{const e=JSON.stringify(p,null,2),s=new Blob([e],{type:"application/json"}),t=URL.createObjectURL(s),a=document.createElement("a");a.href=t,a.download=`performance-metrics-${(new Date).toISOString().split("T")[0]}.json`,a.click(),URL.revokeObjectURL(t)},className:"px-3 py-1 bg-purple-500 hover:bg-purple-600 text-white rounded text-sm font-medium",disabled:0===p.length,children:"Export"}),(0,c.jsx)("button",{onClick:t,className:"px-3 py-1 bg-gray-500 hover:bg-gray-600 text-white rounded text-sm font-medium",children:"Close"})]})]}),(0,c.jsxs)("div",{className:"p-4 overflow-y-auto max-h-full",children:[(0,c.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[d.memory&&(0,c.jsxs)("div",{className:`${v} border rounded-lg p-4`,children:[(0,c.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"Memory Usage"}),(0,c.jsxs)("div",{className:"space-y-2",children:[(0,c.jsxs)("div",{className:"flex justify-between",children:[(0,c.jsx)("span",{children:"Used Heap:"}),(0,c.jsxs)("span",{className:"font-mono",children:[d.memory.usedJSHeapSize," MB"]})]}),(0,c.jsxs)("div",{className:"flex justify-between",children:[(0,c.jsx)("span",{children:"Total Heap:"}),(0,c.jsxs)("span",{className:"font-mono",children:[d.memory.totalJSHeapSize," MB"]})]}),(0,c.jsxs)("div",{className:"flex justify-between",children:[(0,c.jsx)("span",{children:"Heap Limit:"}),(0,c.jsxs)("span",{className:"font-mono",children:[d.memory.jsHeapSizeLimit," MB"]})]}),(0,c.jsxs)("div",{className:"flex justify-between",children:[(0,c.jsx)("span",{children:"Usage:"}),(0,c.jsxs)("span",{className:"font-mono "+(d.memory.usage>80?"text-red-500":d.memory.usage>60?"text-yellow-500":"text-green-500"),children:[d.memory.usage,"%"]})]}),(0,c.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:(0,c.jsx)("div",{className:"h-2 rounded-full "+(d.memory.usage>80?"bg-red-500":d.memory.usage>60?"bg-yellow-500":"bg-green-500"),style:{width:`${Math.min(d.memory.usage,100)}%`}})})]})]}),d.resources&&(0,c.jsxs)("div",{className:`${v} border rounded-lg p-4`,children:[(0,c.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"Resource Metrics"}),(0,c.jsxs)("div",{className:"space-y-2",children:[(0,c.jsxs)("div",{className:"flex justify-between",children:[(0,c.jsx)("span",{children:"Total Resources:"}),(0,c.jsx)("span",{className:"font-mono",children:d.resources.totalResources})]}),(0,c.jsxs)("div",{className:"flex justify-between",children:[(0,c.jsx)("span",{children:"Load Time:"}),(0,c.jsxs)("span",{className:"font-mono "+(d.resources.totalLoadTime>3e3?"text-red-500":d.resources.totalLoadTime>1500?"text-yellow-500":"text-green-500"),children:[Math.round(d.resources.totalLoadTime),"ms"]})]}),(0,c.jsxs)("div",{className:"flex justify-between",children:[(0,c.jsx)("span",{children:"DOM Content Loaded:"}),(0,c.jsxs)("span",{className:"font-mono "+(d.resources.domContentLoaded>1500?"text-red-500":d.resources.domContentLoaded>800?"text-yellow-500":"text-green-500"),children:[Math.round(d.resources.domContentLoaded),"ms"]})]})]})]}),d.bundle&&(0,c.jsxs)("div",{className:`${v} border rounded-lg p-4`,children:[(0,c.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"Bundle Analysis"}),(0,c.jsxs)("div",{className:"space-y-2",children:[(0,c.jsxs)("div",{className:"flex justify-between",children:[(0,c.jsx)("span",{children:"Scripts:"}),(0,c.jsx)("span",{className:"font-mono",children:d.bundle.totalScripts})]}),(0,c.jsxs)("div",{className:"flex justify-between",children:[(0,c.jsx)("span",{children:"Stylesheets:"}),(0,c.jsx)("span",{className:"font-mono",children:d.bundle.totalStylesheets})]})]})]}),d.budget&&(0,c.jsxs)("div",{className:`${v} border rounded-lg p-4`,children:[(0,c.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"Performance Budget"}),(0,c.jsx)("div",{className:"space-y-2",children:Object.entries(d.budget).map(e=>{let[s,t]=e;return(0,c.jsxs)("div",{className:"flex justify-between items-center",children:[(0,c.jsxs)("span",{className:"capitalize",children:[s.replace(/([A-Z])/g," $1").trim(),":"]}),(0,c.jsx)("span",{className:"font-mono px-2 py-1 rounded text-xs "+(t.passed?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:t.passed?"PASS":"FAIL"})]},s)})})]})]}),d.recommendations&&d.recommendations.length>0&&(0,c.jsxs)("div",{className:`${v} border rounded-lg p-4 mt-6`,children:[(0,c.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"Optimization Recommendations"}),(0,c.jsx)("ul",{className:"space-y-2",children:d.recommendations.map((e,s)=>(0,c.jsxs)("li",{className:"flex items-start",children:[(0,c.jsx)("span",{className:"text-blue-500 mr-2",children:"\u2022"}),(0,c.jsx)("span",{children:e})]},s))})]}),d.resources&&d.resources.largestResources&&(0,c.jsxs)("div",{className:`${v} border rounded-lg p-4 mt-6`,children:[(0,c.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"Largest Resources"}),(0,c.jsx)("div",{className:"overflow-x-auto",children:(0,c.jsxs)("table",{className:"w-full text-sm",children:[(0,c.jsx)("thead",{children:(0,c.jsxs)("tr",{className:"border-b border-gray-300 dark:border-gray-600",children:[(0,c.jsx)("th",{className:"text-left py-2",children:"Resource"}),(0,c.jsx)("th",{className:"text-left py-2",children:"Size"}),(0,c.jsx)("th",{className:"text-left py-2",children:"Duration"}),(0,c.jsx)("th",{className:"text-left py-2",children:"Type"})]})}),(0,c.jsx)("tbody",{children:d.resources.largestResources.slice(0,5).map((e,s)=>(0,c.jsxs)("tr",{className:"border-b border-gray-200 dark:border-gray-700",children:[(0,c.jsx)("td",{className:"py-2 truncate max-w-xs",title:e.name,children:e.name.split("/").pop()}),(0,c.jsx)("td",{className:"py-2 font-mono",children:e.size?`${Math.round(e.size/1024)} KB`:"N/A"}),(0,c.jsxs)("td",{className:"py-2 font-mono",children:[Math.round(e.duration),"ms"]}),(0,c.jsx)("td",{className:"py-2",children:e.type})]},s))})]})})]}),p.length>1&&(0,c.jsxs)("div",{className:`${v} border rounded-lg p-4 mt-6`,children:[(0,c.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,c.jsx)("h3",{className:"text-lg font-semibold",children:"Performance History"}),(0,c.jsx)("button",{onClick:()=>{x([])},className:"px-2 py-1 bg-red-500 hover:bg-red-600 text-white rounded text-xs",children:"Clear History"})]}),(0,c.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Showing last ",p.length," measurements"]}),(0,c.jsx)("div",{className:"mt-2 space-y-1 max-h-32 overflow-y-auto",children:p.slice(-5).map((e,s)=>(0,c.jsxs)("div",{className:"text-xs font-mono",children:[new Date(e.timestamp).toLocaleTimeString(),":",e.memory&&` Memory: ${e.memory.usage}%`,e.resources&&` Load: ${Math.round(e.resources.totalLoadTime)}ms`]},s))})]})]})]})})}}}]);
//# sourceMappingURL=360.36e0e44d.chunk.js.map