"use strict";(self.webpackChunkjsg_inspections=self.webpackChunkjsg_inspections||[]).push([[564],{9564:(e,t,a)=>{a.r(t),a.d(t,{default:()=>d});var l=a(5043),s=a(579);const n=[{value:"text",label:"Text"},{value:"number",label:"Number"},{value:"date",label:"Date"},{value:"dropdown",label:"Dropdown"},{value:"checkbox",label:"Checkbox"},{value:"signature",label:"Signature"},{value:"photo",label:"Photo"}],i={templates:{},selectedTemplate:null,newTemplateName:"",sections:[]};function o(e,t){switch(t.type){case"SET_TEMPLATES":return{...e,templates:t.payload};case"SELECT_TEMPLATE":const a=e.templates[t.payload];return{...e,selectedTemplate:t.payload,sections:a?a.sections:[],newTemplateName:t.payload};case"UPDATE_NEW_TEMPLATE_NAME":return{...e,newTemplateName:t.payload};case"ADD_SECTION":const l={id:Date.now(),name:`New Section ${e.sections.length+1}`,items:[]};return{...e,sections:[...e.sections,l]};case"UPDATE_SECTION_NAME":return{...e,sections:e.sections.map(e=>e.id===t.payload.id?{...e,name:t.payload.name}:e)};case"DELETE_SECTION":return{...e,sections:e.sections.filter(e=>e.id!==t.payload)};case"ADD_ITEM":const s={id:Date.now(),text:"New Item",fieldType:"text"};return{...e,sections:e.sections.map(e=>e.id===t.payload.sectionId?{...e,items:[...e.items,s]}:e)};case"UPDATE_ITEM":return{...e,sections:e.sections.map(e=>e.id===t.payload.sectionId?{...e,items:e.items.map(e=>e.id===t.payload.item.id?t.payload.item:e)}:e)};case"DELETE_ITEM":return{...e,sections:e.sections.map(e=>e.id===t.payload.sectionId?{...e,items:e.items.filter(e=>e.id!==t.payload.itemId)}:e)};case"RESET":return{...i,templates:e.templates};default:return e}}const d=function(){const[e,t]=(0,l.useReducer)(o,i);return(0,l.useEffect)(()=>{!async function(){try{const e=(await window.api.templates.getAll()).reduce((e,t)=>(e[t.name]={id:t.id,...JSON.parse(t.fields)},e),{});t({type:"SET_TEMPLATES",payload:e})}catch(e){console.error("Failed to fetch templates:",e)}}()},[]),(0,s.jsxs)("div",{className:"template-builder",children:[(0,s.jsx)("h2",{children:"Custom Inspection Template Builder"}),(0,s.jsxs)("div",{className:"template-controls",children:[(0,s.jsxs)("select",{value:e.selectedTemplate||"",onChange:e=>t({type:"SELECT_TEMPLATE",payload:e.target.value}),children:[(0,s.jsx)("option",{value:"",children:"Select a template to edit"}),Object.keys(e.templates).map(e=>(0,s.jsx)("option",{value:e,children:e},e))]}),(0,s.jsx)("input",{type:"text",placeholder:"New or updated template name",value:e.newTemplateName,onChange:e=>t({type:"UPDATE_NEW_TEMPLATE_NAME",payload:e.target.value})}),(0,s.jsx)("button",{onClick:async()=>{if(!e.newTemplateName)return void alert("Please enter a template name.");const a={sections:e.sections};try{await window.api.templates.save(e.newTemplateName,JSON.stringify(a)),t({type:"SET_TEMPLATES",payload:{...e.templates,[e.newTemplateName]:a}}),alert("Template saved successfully!")}catch(l){console.error("Failed to save template:",l),alert("Error saving template.")}},children:"Save Template"}),(0,s.jsx)("button",{onClick:()=>t({type:"RESET"}),children:"New Template"}),(0,s.jsx)("button",{onClick:async()=>{if(!e.selectedTemplate)return void alert("Please select a template to delete.");const a=e.templates[e.selectedTemplate];if(a&&a.id)try{await window.api.templates.delete(a.id);const l={...e.templates};delete l[e.selectedTemplate],t({type:"SET_TEMPLATES",payload:l}),t({type:"RESET"}),alert("Template deleted successfully!")}catch(l){console.error("Failed to delete template:",l),alert("Error deleting template.")}else alert("Cannot delete - template ID not found.")},className:"delete-button",children:"Delete Selected Template"})]}),(0,s.jsxs)("div",{className:"template-editor",children:[e.sections.map(e=>(0,s.jsxs)("div",{className:"section",children:[(0,s.jsxs)("div",{className:"section-header",children:[(0,s.jsx)("input",{type:"text",value:e.name,onChange:a=>t({type:"UPDATE_SECTION_NAME",payload:{id:e.id,name:a.target.value}})}),(0,s.jsx)("button",{onClick:()=>t({type:"DELETE_SECTION",payload:e.id}),children:"Delete Section"})]}),(0,s.jsxs)("div",{className:"section-items",children:[e.items.map(a=>{var l;return(0,s.jsxs)("div",{className:"item",children:[(0,s.jsx)("input",{type:"text",value:a.text,onChange:l=>t({type:"UPDATE_ITEM",payload:{sectionId:e.id,item:{...a,text:l.target.value}}})}),(0,s.jsx)("select",{value:a.fieldType,onChange:l=>t({type:"UPDATE_ITEM",payload:{sectionId:e.id,item:{...a,fieldType:l.target.value}}}),children:n.map(e=>(0,s.jsx)("option",{value:e.value,children:e.label},e.value))}),"dropdown"===a.fieldType&&(0,s.jsx)("input",{type:"text",placeholder:"Options (comma-separated)",value:(null===(l=a.options)||void 0===l?void 0:l.join(","))||"",onChange:l=>t({type:"UPDATE_ITEM",payload:{sectionId:e.id,item:{...a,options:l.target.value.split(",")}}})}),(0,s.jsx)("button",{onClick:()=>t({type:"DELETE_ITEM",payload:{sectionId:e.id,itemId:a.id}}),children:"Delete"})]},a.id)}),(0,s.jsx)("button",{onClick:()=>t({type:"ADD_ITEM",payload:{sectionId:e.id}}),children:"Add Item"})]})]},e.id)),(0,s.jsx)("button",{onClick:()=>t({type:"ADD_SECTION"}),children:"Add Section"})]})]})}}}]);
//# sourceMappingURL=564.43bd09e5.chunk.js.map