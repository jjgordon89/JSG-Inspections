"use strict";(self.webpackChunkjsg_inspections=self.webpackChunkjsg_inspections||[]).push([[904,928,948],{928:(e,s,a)=>{a.r(s),a.d(s,{default:()=>r});a(5043);var l=a(579);const r=e=>{let{newWorkOrder:s,setNewWorkOrder:a,equipment:r,onSubmit:t,onCancel:i}=e;const n=(e,s)=>{a(a=>({...a,[e]:s}))};return(0,l.jsx)("div",{className:"modal-overlay",children:(0,l.jsxs)("div",{className:"modal-content",children:[(0,l.jsxs)("div",{className:"modal-header",children:[(0,l.jsx)("h2",{children:"Create New Work Order"}),(0,l.jsx)("button",{className:"close-button",onClick:i,children:"\xd7"})]}),(0,l.jsxs)("form",{onSubmit:t,className:"create-form",children:[(0,l.jsxs)("div",{className:"form-row",children:[(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{children:"Equipment *"}),(0,l.jsxs)("select",{value:s.equipmentId,onChange:e=>n("equipmentId",e.target.value),required:!0,children:[(0,l.jsx)("option",{value:"",children:"Select Equipment"}),r.map(e=>(0,l.jsxs)("option",{value:e.id,children:[e.identifier," - ",e.name]},e.id))]})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{children:"Work Type"}),(0,l.jsxs)("select",{value:s.workType,onChange:e=>n("workType",e.target.value),children:[(0,l.jsx)("option",{value:"corrective",children:"Corrective"}),(0,l.jsx)("option",{value:"preventive",children:"Preventive"}),(0,l.jsx)("option",{value:"emergency",children:"Emergency"}),(0,l.jsx)("option",{value:"project",children:"Project"})]})]})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{children:"Title *"}),(0,l.jsx)("input",{type:"text",value:s.title,onChange:e=>n("title",e.target.value),placeholder:"Brief description of work to be performed",required:!0})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{children:"Description"}),(0,l.jsx)("textarea",{value:s.description,onChange:e=>n("description",e.target.value),rows:"4",placeholder:"Detailed description of the work required, including any specific instructions or safety considerations"})]}),(0,l.jsxs)("div",{className:"form-row",children:[(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{children:"Priority"}),(0,l.jsxs)("select",{value:s.priority,onChange:e=>n("priority",e.target.value),children:[(0,l.jsx)("option",{value:"low",children:"Low"}),(0,l.jsx)("option",{value:"medium",children:"Medium"}),(0,l.jsx)("option",{value:"high",children:"High"}),(0,l.jsx)("option",{value:"critical",children:"Critical"})]})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{children:"Estimated Hours"}),(0,l.jsx)("input",{type:"number",step:"0.5",min:"0",value:s.estimatedHours,onChange:e=>n("estimatedHours",e.target.value),placeholder:"0.0"})]})]}),(0,l.jsxs)("div",{className:"form-row",children:[(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{children:"Assigned To"}),(0,l.jsx)("input",{type:"text",value:s.assignedTo,onChange:e=>n("assignedTo",e.target.value),placeholder:"Technician or team member name"})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{children:"Scheduled Date"}),(0,l.jsx)("input",{type:"date",value:s.scheduledDate,onChange:e=>n("scheduledDate",e.target.value)})]})]}),(0,l.jsxs)("div",{className:"form-actions",children:[(0,l.jsx)("button",{type:"button",onClick:i,className:"cancel-button",children:"Cancel"}),(0,l.jsx)("button",{type:"submit",className:"submit-button",children:"Create Work Order"})]})]})]})})}},6904:(e,s,a)=>{a.r(s),a.d(s,{default:()=>r});a(5043);var l=a(579);const r=e=>{let{workOrder:s,completionData:a,setCompletionData:r,onSubmit:t,onCancel:i}=e;const n=(e,s)=>{r(a=>({...a,[e]:s}))};return(0,l.jsx)("div",{className:"modal-overlay",children:(0,l.jsxs)("div",{className:"modal-content",children:[(0,l.jsxs)("div",{className:"modal-header",children:[(0,l.jsxs)("h2",{children:["Complete Work Order - ",s.wo_number]}),(0,l.jsx)("button",{className:"close-button",onClick:i,children:"\xd7"})]}),(0,l.jsxs)("form",{onSubmit:t,className:"completion-form",children:[(0,l.jsxs)("div",{className:"completion-summary",children:[(0,l.jsx)("h3",{children:s.title}),(0,l.jsxs)("div",{className:"summary-details",children:[(0,l.jsxs)("div",{className:"summary-item",children:[(0,l.jsx)("span",{className:"summary-label",children:"Equipment:"}),(0,l.jsx)("span",{className:"summary-value",children:s.equipment_identifier})]}),s.estimated_hours&&(0,l.jsxs)("div",{className:"summary-item",children:[(0,l.jsx)("span",{className:"summary-label",children:"Estimated Hours:"}),(0,l.jsxs)("span",{className:"summary-value",children:[s.estimated_hours,"h"]})]}),(0,l.jsxs)("div",{className:"summary-item",children:[(0,l.jsx)("span",{className:"summary-label",children:"Work Type:"}),(0,l.jsx)("span",{className:"summary-value",children:s.work_type})]}),(0,l.jsxs)("div",{className:"summary-item",children:[(0,l.jsx)("span",{className:"summary-label",children:"Priority:"}),(0,l.jsx)("span",{className:"summary-value",children:s.priority})]})]})]}),(0,l.jsxs)("div",{className:"form-section",children:[(0,l.jsx)("h4",{children:"Work Completion Details"}),(0,l.jsxs)("div",{className:"form-row",children:[(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{children:"Actual Hours Worked *"}),(0,l.jsx)("input",{type:"number",step:"0.5",min:"0",value:a.actualHours,onChange:e=>n("actualHours",e.target.value),placeholder:"0.0",required:!0}),(0,l.jsx)("small",{className:"form-help",children:"Total time spent on this work order"})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{children:"Parts Cost ($)"}),(0,l.jsx)("input",{type:"number",step:"0.01",min:"0",value:a.partsCost,onChange:e=>n("partsCost",e.target.value),placeholder:"0.00"}),(0,l.jsx)("small",{className:"form-help",children:"Cost of parts and materials used"})]})]}),(0,l.jsxs)("div",{className:"form-row",children:[(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{children:"Labor Cost ($)"}),(0,l.jsx)("input",{type:"number",step:"0.01",min:"0",value:a.laborCost,onChange:e=>n("laborCost",e.target.value),placeholder:"0.00"}),(0,l.jsx)("small",{className:"form-help",children:"Labor charges for this work"})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{children:"Total Cost"}),(0,l.jsx)("input",{type:"text",value:`$${((parseFloat(a.partsCost)||0)+(parseFloat(a.laborCost)||0)).toFixed(2)}`,disabled:!0,className:"calculated-field"}),(0,l.jsx)("small",{className:"form-help",children:"Automatically calculated total"})]})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{children:"Completion Notes *"}),(0,l.jsx)("textarea",{value:a.completionNotes,onChange:e=>n("completionNotes",e.target.value),rows:"6",placeholder:"Describe work performed, any issues encountered, parts used, and recommendations for future maintenance...",required:!0}),(0,l.jsx)("small",{className:"form-help",children:"Detailed description of work completed, issues found, and recommendations"})]})]}),(0,l.jsxs)("div",{className:"form-actions",children:[(0,l.jsx)("button",{type:"button",onClick:i,className:"cancel-button",children:"Cancel"}),(0,l.jsx)("button",{type:"submit",className:"submit-button",children:"Complete Work Order"})]})]})]})})}},7948:(e,s,a)=>{a.r(s),a.d(s,{default:()=>c});var l=a(5043),r=a(4107),t=a(579);const i=e=>{let{workOrder:s,onStatusChange:a,onComplete:l,onViewDetails:r,getStatusBadge:i,getPriorityBadge:n,getWorkTypeBadge:d}=e;const c=e=>e?new Date(e).toLocaleDateString():"Not set";return(0,t.jsxs)("div",{className:"work-order-card",children:[(0,t.jsxs)("div",{className:"card-header",children:[(0,t.jsx)("div",{className:"wo-number",children:s.wo_number}),(0,t.jsxs)("div",{className:"card-badges",children:[i(s.status),n(s.priority),d(s.work_type)]})]}),(0,t.jsxs)("div",{className:"card-content",children:[(0,t.jsx)("h3",{className:"wo-title",children:s.title}),(0,t.jsx)("p",{className:"wo-description",children:s.description}),(0,t.jsxs)("div",{className:"wo-details",children:[(0,t.jsxs)("div",{className:"detail-item",children:[(0,t.jsx)("span",{className:"detail-label",children:"Equipment:"}),(0,t.jsx)("span",{className:"detail-value",children:s.equipment_identifier})]}),s.assigned_to&&(0,t.jsxs)("div",{className:"detail-item",children:[(0,t.jsx)("span",{className:"detail-label",children:"Assigned to:"}),(0,t.jsx)("span",{className:"detail-value",children:s.assigned_to})]}),(0,t.jsxs)("div",{className:"detail-item",children:[(0,t.jsx)("span",{className:"detail-label",children:"Created:"}),(0,t.jsx)("span",{className:"detail-value",children:c(s.created_at)})]}),s.scheduled_date&&(0,t.jsxs)("div",{className:"detail-item",children:[(0,t.jsx)("span",{className:"detail-label",children:"Scheduled:"}),(0,t.jsx)("span",{className:"detail-value",children:c(s.scheduled_date)})]}),s.estimated_hours&&(0,t.jsxs)("div",{className:"detail-item",children:[(0,t.jsx)("span",{className:"detail-label",children:"Est. Hours:"}),(0,t.jsxs)("span",{className:"detail-value",children:[s.estimated_hours,"h"]})]}),s.actual_hours&&(0,t.jsxs)("div",{className:"detail-item",children:[(0,t.jsx)("span",{className:"detail-label",children:"Actual Hours:"}),(0,t.jsxs)("span",{className:"detail-value",children:[s.actual_hours,"h"]})]}),(s.parts_cost||s.labor_cost)&&(0,t.jsxs)("div",{className:"detail-item",children:[(0,t.jsx)("span",{className:"detail-label",children:"Total Cost:"}),(0,t.jsx)("span",{className:"detail-value",children:(u=(s.parts_cost||0)+(s.labor_cost||0),u?`$${parseFloat(u).toFixed(2)}`:"$0.00")})]})]})]}),(0,t.jsxs)("div",{className:"card-actions",children:[(0,t.jsx)("button",{className:"view-details-btn",onClick:()=>r(s),children:"View Details"}),(m=s.status,["draft","approved","assigned","in_progress"].includes(m)&&(0,t.jsx)(t.Fragment,{children:"in_progress"===s.status?(0,t.jsx)("button",{className:"complete-btn",onClick:()=>l(s),children:"Complete"}):(0,t.jsx)("button",{className:"status-btn",onClick:()=>a(s.id,(e=>({draft:"approved",approved:"assigned",assigned:"in_progress",in_progress:"completed"}[e]))(s.status)),children:(o=s.status,{draft:"Approve",approved:"Assign",assigned:"Start Work",in_progress:"Complete"}[o]||"Update")})}))]})]});var o,m,u};var n=a(928),d=a(6904);const c=()=>{const{currentUser:e}=(0,r.J)(),[s,a]=(0,l.useState)([]),[c,o]=(0,l.useState)([]),[m,u]=(0,l.useState)(!0),[p,h]=(0,l.useState)(null),[j,x]=(0,l.useState)(!1),[v,N]=(0,l.useState)("all"),[g,b]=(0,l.useState)(null),[y,w]=(0,l.useState)(!1),[f,k]=(0,l.useState)({actualHours:"",partsCost:"",laborCost:"",completionNotes:""}),[C,_]=(0,l.useState)({equipmentId:"",title:"",description:"",workType:"corrective",priority:"medium",assignedTo:"",estimatedHours:"",scheduledDate:"",deficiencyId:null});(0,l.useEffect)(()=>{S()},[]);const S=async()=>{try{u(!0),h(null);const[e,s]=await Promise.all([window.api.workOrders.getAll(),window.api.equipment.getAll()]);a(e),o(s)}catch(e){console.error("Error loading work orders:",e),h(e.message)}finally{u(!1)}},D=async(s,a)=>{try{const l=(new Date).toISOString(),r={id:s,status:a,startedAt:"in_progress"===a?l:null,completedAt:"completed"===a?l:null,closedAt:"closed"===a?l:null};await window.api.workOrders.updateStatus(r),await window.api.auditLog.create({userId:(null===e||void 0===e?void 0:e.id)||null,username:(null===e||void 0===e?void 0:e.username)||"Unknown User",action:"update",entityType:"work_order",entityId:s,oldValues:null,newValues:JSON.stringify({status:a}),ipAddress:null,userAgent:navigator.userAgent}),await S()}catch(l){console.error("Error updating work order status:",l),h(l.message)}},O=async e=>{b(e),k({actualHours:"",partsCost:"",laborCost:"",completionNotes:""}),w(!0)},T=e=>{const s={draft:{class:"status-draft",label:"Draft"},approved:{class:"status-approved",label:"Approved"},assigned:{class:"status-assigned",label:"Assigned"},in_progress:{class:"status-in-progress",label:"In Progress"},completed:{class:"status-completed",label:"Completed"},closed:{class:"status-closed",label:"Closed"},cancelled:{class:"status-cancelled",label:"Cancelled"}}[e]||{class:"status-unknown",label:e};return(0,t.jsx)("span",{className:`status-badge ${s.class}`,children:s.label})},A=e=>{const s={low:{class:"priority-low",label:"Low"},medium:{class:"priority-medium",label:"Medium"},high:{class:"priority-high",label:"High"},critical:{class:"priority-critical",label:"Critical"}}[e]||{class:"priority-unknown",label:e};return(0,t.jsx)("span",{className:`priority-badge ${s.class}`,children:s.label})},W=e=>{const s={preventive:{class:"type-preventive",label:"Preventive",icon:"\ud83d\udd27"},corrective:{class:"type-corrective",label:"Corrective",icon:"\u26a0\ufe0f"},emergency:{class:"type-emergency",label:"Emergency",icon:"\ud83d\udea8"},project:{class:"type-project",label:"Project",icon:"\ud83d\udccb"}}[e]||{class:"type-unknown",label:e,icon:"\u2753"};return(0,t.jsxs)("span",{className:`work-type-badge ${s.class}`,children:[s.icon," ",s.label]})},I=s.filter(e=>"all"===v||("open"===v?["draft","approved","assigned"].includes(e.status):e.status===v));return m?(0,t.jsxs)("div",{className:"work-orders",children:[(0,t.jsx)("div",{className:"work-orders-header",children:(0,t.jsx)("h1",{children:"Work Orders"})}),(0,t.jsx)("div",{className:"loading-spinner",children:"Loading work orders..."})]}):p?(0,t.jsxs)("div",{className:"work-orders",children:[(0,t.jsx)("div",{className:"work-orders-header",children:(0,t.jsx)("h1",{children:"Work Orders"})}),(0,t.jsxs)("div",{className:"error-message",children:[(0,t.jsxs)("p",{children:["Error loading work orders: ",p]}),(0,t.jsx)("button",{onClick:S,className:"retry-button",children:"Retry"})]})]}):(0,t.jsxs)("div",{className:"work-orders",children:[(0,t.jsxs)("div",{className:"work-orders-header",children:[(0,t.jsx)("h1",{children:"Work Orders"}),(0,t.jsxs)("div",{className:"header-actions",children:[(0,t.jsx)("div",{className:"filter-controls",children:(0,t.jsxs)("select",{value:v,onChange:e=>N(e.target.value),className:"status-filter",children:[(0,t.jsx)("option",{value:"all",children:"All Status"}),(0,t.jsx)("option",{value:"open",children:"Open"}),(0,t.jsx)("option",{value:"draft",children:"Draft"}),(0,t.jsx)("option",{value:"approved",children:"Approved"}),(0,t.jsx)("option",{value:"assigned",children:"Assigned"}),(0,t.jsx)("option",{value:"in_progress",children:"In Progress"}),(0,t.jsx)("option",{value:"completed",children:"Completed"}),(0,t.jsx)("option",{value:"closed",children:"Closed"})]})}),(0,t.jsx)("button",{className:"create-button",onClick:()=>x(!0),children:"+ Create Work Order"})]})]}),(0,t.jsxs)("div",{className:"work-orders-summary",children:[(0,t.jsxs)("div",{className:"summary-card",children:[(0,t.jsx)("span",{className:"summary-value",children:s.length}),(0,t.jsx)("span",{className:"summary-label",children:"Total Work Orders"})]}),(0,t.jsxs)("div",{className:"summary-card",children:[(0,t.jsx)("span",{className:"summary-value status-warning",children:s.filter(e=>["draft","approved","assigned"].includes(e.status)).length}),(0,t.jsx)("span",{className:"summary-label",children:"Open"})]}),(0,t.jsxs)("div",{className:"summary-card",children:[(0,t.jsx)("span",{className:"summary-value status-good",children:s.filter(e=>"in_progress"===e.status).length}),(0,t.jsx)("span",{className:"summary-label",children:"In Progress"})]}),(0,t.jsxs)("div",{className:"summary-card",children:[(0,t.jsx)("span",{className:"summary-value status-critical",children:s.filter(e=>"critical"===e.priority).length}),(0,t.jsx)("span",{className:"summary-label",children:"Critical Priority"})]})]}),(0,t.jsx)("div",{className:"work-orders-list",children:0===I.length?(0,t.jsxs)("div",{className:"empty-state",children:[(0,t.jsx)("p",{children:"No work orders found for the selected filter."}),(0,t.jsx)("button",{className:"create-button",onClick:()=>x(!0),children:"Create First Work Order"})]}):I.map(e=>(0,t.jsx)(i,{workOrder:e,onStatusChange:D,onComplete:O,onViewDetails:b,getStatusBadge:T,getPriorityBadge:A,getWorkTypeBadge:W},e.id))}),j&&(0,t.jsx)(n.default,{newWorkOrder:C,setNewWorkOrder:_,equipment:c,onSubmit:async s=>{s.preventDefault();try{const s=`WO-${Date.now().toString().slice(-6)}`;if(!c.find(e=>e.id===parseInt(C.equipmentId)))throw new Error("Please select valid equipment");const a=await window.api.workOrders.create({equipmentId:parseInt(C.equipmentId),woNumber:s,title:C.title,description:C.description,workType:C.workType,priority:C.priority,assignedTo:C.assignedTo||null,estimatedHours:C.estimatedHours?parseFloat(C.estimatedHours):null,createdBy:(null===e||void 0===e?void 0:e.full_name)||"Unknown User",scheduledDate:C.scheduledDate||null,deficiencyId:C.deficiencyId}),l=(null===a||void 0===a?void 0:a.lastID)||(null===a||void 0===a?void 0:a.id)||0;await window.api.auditLog.create({userId:(null===e||void 0===e?void 0:e.id)||null,username:(null===e||void 0===e?void 0:e.username)||"Unknown User",action:"create",entityType:"work_order",entityId:l,oldValues:null,newValues:JSON.stringify({...C,woNumber:s}),ipAddress:null,userAgent:navigator.userAgent}),x(!1),_({equipmentId:"",title:"",description:"",workType:"corrective",priority:"medium",assignedTo:"",estimatedHours:"",scheduledDate:"",deficiencyId:null}),await S()}catch(a){console.error("Error creating work order:",a),h(a.message)}},onCancel:()=>x(!1)}),g&&(0,t.jsx)("div",{className:"modal-overlay",children:(0,t.jsxs)("div",{className:"modal-content large",children:[(0,t.jsxs)("div",{className:"modal-header",children:[(0,t.jsxs)("h2",{children:["Work Order Details - ",g.wo_number]}),(0,t.jsx)("button",{className:"close-button",onClick:()=>b(null),children:"\xd7"})]}),(0,t.jsxs)("div",{className:"work-order-details-content",children:[(0,t.jsxs)("div",{className:"details-section",children:[(0,t.jsx)("h3",{children:"Basic Information"}),(0,t.jsxs)("div",{className:"details-grid",children:[(0,t.jsxs)("div",{className:"detail-item",children:[(0,t.jsx)("span",{className:"detail-label",children:"Equipment:"}),(0,t.jsx)("span",{className:"detail-value",children:g.equipment_identifier})]}),(0,t.jsxs)("div",{className:"detail-item",children:[(0,t.jsx)("span",{className:"detail-label",children:"Status:"}),T(g.status)]}),(0,t.jsxs)("div",{className:"detail-item",children:[(0,t.jsx)("span",{className:"detail-label",children:"Priority:"}),A(g.priority)]}),(0,t.jsxs)("div",{className:"detail-item",children:[(0,t.jsx)("span",{className:"detail-label",children:"Work Type:"}),W(g.work_type)]}),(0,t.jsxs)("div",{className:"detail-item",children:[(0,t.jsx)("span",{className:"detail-label",children:"Created By:"}),(0,t.jsx)("span",{className:"detail-value",children:g.created_by})]}),(0,t.jsxs)("div",{className:"detail-item",children:[(0,t.jsx)("span",{className:"detail-label",children:"Created:"}),(0,t.jsx)("span",{className:"detail-value",children:new Date(g.created_at).toLocaleString()})]})]})]}),(0,t.jsxs)("div",{className:"details-section",children:[(0,t.jsx)("h3",{children:"Work Description"}),(0,t.jsxs)("div",{className:"description-content",children:[(0,t.jsx)("h4",{children:g.title}),g.description&&(0,t.jsx)("p",{children:g.description})]})]}),(0,t.jsxs)("div",{className:"details-section",children:[(0,t.jsx)("h3",{children:"Schedule & Resources"}),(0,t.jsxs)("div",{className:"details-grid",children:[g.assigned_to&&(0,t.jsxs)("div",{className:"detail-item",children:[(0,t.jsx)("span",{className:"detail-label",children:"Assigned To:"}),(0,t.jsx)("span",{className:"detail-value",children:g.assigned_to})]}),g.scheduled_date&&(0,t.jsxs)("div",{className:"detail-item",children:[(0,t.jsx)("span",{className:"detail-label",children:"Scheduled Date:"}),(0,t.jsx)("span",{className:"detail-value",children:new Date(g.scheduled_date).toLocaleDateString()})]}),g.estimated_hours&&(0,t.jsxs)("div",{className:"detail-item",children:[(0,t.jsx)("span",{className:"detail-label",children:"Estimated Hours:"}),(0,t.jsxs)("span",{className:"detail-value",children:[g.estimated_hours,"h"]})]}),g.actual_hours&&(0,t.jsxs)("div",{className:"detail-item",children:[(0,t.jsx)("span",{className:"detail-label",children:"Actual Hours:"}),(0,t.jsxs)("span",{className:"detail-value",children:[g.actual_hours,"h"]})]})]})]}),(g.parts_cost>0||g.labor_cost>0)&&(0,t.jsxs)("div",{className:"details-section",children:[(0,t.jsx)("h3",{children:"Costs"}),(0,t.jsxs)("div",{className:"details-grid",children:[(0,t.jsxs)("div",{className:"detail-item",children:[(0,t.jsx)("span",{className:"detail-label",children:"Parts Cost:"}),(0,t.jsxs)("span",{className:"detail-value",children:["$",g.parts_cost||0]})]}),(0,t.jsxs)("div",{className:"detail-item",children:[(0,t.jsx)("span",{className:"detail-label",children:"Labor Cost:"}),(0,t.jsxs)("span",{className:"detail-value",children:["$",g.labor_cost||0]})]}),(0,t.jsxs)("div",{className:"detail-item",children:[(0,t.jsx)("span",{className:"detail-label",children:"Total Cost:"}),(0,t.jsxs)("span",{className:"detail-value total-cost",children:["$",(g.parts_cost||0)+(g.labor_cost||0)]})]})]})]}),g.completion_notes&&(0,t.jsxs)("div",{className:"details-section",children:[(0,t.jsx)("h3",{children:"Completion Notes"}),(0,t.jsx)("p",{children:g.completion_notes})]})]}),(0,t.jsx)("div",{className:"modal-actions",children:(0,t.jsx)("button",{className:"close-modal-button",onClick:()=>b(null),children:"Close"})})]})}),y&&g&&(0,t.jsx)(d.default,{selectedWorkOrder:g,completionData:f,setCompletionData:k,onSubmit:async s=>{s.preventDefault();try{await window.api.workOrders.complete({id:g.id,actualHours:f.actualHours?parseFloat(f.actualHours):null,partsCost:f.partsCost?parseFloat(f.partsCost):null,laborCost:f.laborCost?parseFloat(f.laborCost):null,completionNotes:f.completionNotes||null}),await window.api.auditLog.create({userId:(null===e||void 0===e?void 0:e.id)||null,username:(null===e||void 0===e?void 0:e.username)||"Unknown User",action:"complete",entityType:"work_order",entityId:g.id,oldValues:JSON.stringify({status:"in_progress"}),newValues:JSON.stringify({status:"completed",...f}),ipAddress:null,userAgent:navigator.userAgent}),w(!1),b(null),k({actualHours:"",partsCost:"",laborCost:"",completionNotes:""}),await S()}catch(a){console.error("Error completing work order:",a),h(a.message)}},onCancel:()=>w(!1)})]})}}}]);
//# sourceMappingURL=948.712f883a.chunk.js.map