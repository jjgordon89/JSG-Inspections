{"version":3,"file":"static/js/859.7a3e1a6a.chunk.js","mappings":"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","sources":["components/Deficiencies.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useUser } from '../contexts/UserContext';\r\nimport './Deficiencies.css';\r\n\r\nfunction Deficiencies() {\r\n  const { currentUser } = useUser();\r\n  const [deficiencies, setDeficiencies] = useState([]);\r\n  const [equipment, setEquipment] = useState([]);\r\n  const [filter, setFilter] = useState('all');\r\n  const [loading, setLoading] = useState(true);\r\n  const [showCreateDeficiencyForm, setShowCreateDeficiencyForm] = useState(false);\r\n  const [newDeficiency, setNewDeficiency] = useState({\r\n    equipmentId: '',\r\n    severity: 'minor',\r\n    removeFromService: false,\r\n    description: '',\r\n    component: '',\r\n    correctiveAction: '',\r\n    dueDate: ''\r\n  });\r\n\r\n  useEffect(() => {\r\n    loadData();\r\n  }, [filter]);\r\n\r\n  const loadData = async () => {\r\n    try {\r\n      setLoading(true);\r\n      \r\n      const [deficienciesResult, equipmentResult] = await Promise.all([\r\n        filter === 'all' ? window.api.deficiencies.getAll() : window.api.deficiencies.getByStatus(filter),\r\n        window.api.equipment.getAll()\r\n      ]);\r\n      \r\n      setDeficiencies(deficienciesResult);\r\n      setEquipment(equipmentResult);\r\n    } catch (error) {\r\n      console.error('Error loading data:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const fetchDeficiencies = async () => {\r\n    try {\r\n      setLoading(true);\r\n      let result;\r\n      \r\n      if (filter === 'all') {\r\n        result = await window.api.deficiencies.getAll();\r\n      } else {\r\n        result = await window.api.deficiencies.getByStatus(filter);\r\n      }\r\n      \r\n      setDeficiencies(result);\r\n    } catch (error) {\r\n      console.error('Error fetching deficiencies:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleCreateDeficiency = async (e) => {\r\n    e.preventDefault();\r\n    \r\n    try {\r\n      const createResult = await window.api.deficiencies.create({\r\n        equipmentId: parseInt(newDeficiency.equipmentId),\r\n        inspectionItemId: null,\r\n        severity: newDeficiency.severity,\r\n        removeFromService: newDeficiency.removeFromService,\r\n        description: newDeficiency.description,\r\n        component: newDeficiency.component,\r\n        correctiveAction: newDeficiency.correctiveAction,\r\n        dueDate: newDeficiency.dueDate || null,\r\n        status: 'open'\r\n      });\r\n      const createdDeficiencyId = createResult?.lastID || createResult?.id || 0;\r\n\r\n      // Log audit entry\r\n      await window.api.auditLog.create({\r\n        userId: currentUser?.id || null,\r\n        username: currentUser?.username || 'Unknown User',\r\n        action: 'create',\r\n        entityType: 'deficiency',\r\n        entityId: createdDeficiencyId,\r\n        oldValues: null,\r\n        newValues: JSON.stringify(newDeficiency),\r\n        ipAddress: null,\r\n        userAgent: navigator.userAgent\r\n      });\r\n\r\n      setShowCreateDeficiencyForm(false);\r\n      setNewDeficiency({\r\n        equipmentId: '',\r\n        severity: 'minor',\r\n        removeFromService: false,\r\n        description: '',\r\n        component: '',\r\n        correctiveAction: '',\r\n        dueDate: ''\r\n      });\r\n      \r\n      await loadData();\r\n    } catch (error) {\r\n      console.error('Error creating deficiency:', error);\r\n      alert('Failed to create deficiency. Please try again.');\r\n    }\r\n  };\r\n\r\n  const handleCreateWorkOrderFromDeficiency = async (deficiency) => {\r\n    try {\r\n      const equipmentItem = equipment.find(eq => eq.id === deficiency.equipment_id);\r\n      if (!equipmentItem) {\r\n        alert('Equipment not found');\r\n        return;\r\n      }\r\n\r\n      // Generate unique work order number\r\n      const woNumber = `DEF-${equipmentItem.equipment_id}-${new Date().getFullYear()}-${String(Date.now()).slice(-4)}`;\r\n      \r\n      const workOrderData = {\r\n        equipmentId: deficiency.equipment_id,\r\n        woNumber,\r\n        title: `Deficiency Repair - ${deficiency.component || equipmentItem.equipment_id}`,\r\n        description: `${deficiency.description}\\n\\nCorrective Action: ${deficiency.corrective_action || 'To be determined'}`,\r\n        workType: 'corrective',\r\n        priority: deficiency.severity === 'critical' ? 'critical' : deficiency.severity === 'major' ? 'high' : 'medium',\r\n        assignedTo: null,\r\n        estimatedHours: null,\r\n        createdBy: currentUser?.full_name || 'Unknown User',\r\n        scheduledDate: deficiency.due_date,\r\n        deficiencyId: deficiency.id\r\n      };\r\n\r\n      const createWOResult = await window.api.workOrders.create(workOrderData);\r\n      const createdWOId = createWOResult?.lastID || createWOResult?.id || 0;\r\n\r\n      // Link the deficiency to the work order\r\n      await window.api.deficiencies.linkToWorkOrder(deficiency.id, createdWOId);\r\n\r\n      // Log audit entries\r\n      await window.api.auditLog.create({\r\n        userId: currentUser?.id || null,\r\n        username: currentUser?.username || 'Unknown User',\r\n        action: 'create',\r\n        entityType: 'work_order',\r\n        entityId: createdWOId,\r\n        oldValues: null,\r\n        newValues: JSON.stringify(workOrderData),\r\n        ipAddress: null,\r\n        userAgent: navigator.userAgent\r\n      });\r\n\r\n      await window.api.auditLog.create({\r\n        userId: currentUser?.id || null,\r\n        username: currentUser?.username || 'Unknown User',\r\n        action: 'link',\r\n        entityType: 'deficiency',\r\n        entityId: deficiency.id,\r\n        oldValues: JSON.stringify({ work_order_id: null }),\r\n        newValues: JSON.stringify({ work_order_id: createdWOId }),\r\n        ipAddress: null,\r\n        userAgent: navigator.userAgent\r\n      });\r\n\r\n      alert(`Work Order ${woNumber} created and linked to deficiency!`);\r\n      await loadData();\r\n      \r\n    } catch (error) {\r\n      console.error('Error creating work order from deficiency:', error);\r\n      alert('Failed to create work order. Please try again.');\r\n    }\r\n  };\r\n\r\n  const updateDeficiencyStatus = async (deficiencyId, newStatus) => {\r\n    try {\r\n      const deficiency = deficiencies.find(d => d.id === deficiencyId);\r\n      if (!deficiency) return;\r\n\r\n      const oldStatus = deficiency.status;\r\n\r\n      await window.api.deficiencies.update({\r\n        id: deficiencyId,\r\n        severity: deficiency.severity,\r\n        removeFromService: deficiency.remove_from_service,\r\n        description: deficiency.description,\r\n        component: deficiency.component,\r\n        correctiveAction: deficiency.corrective_action,\r\n        dueDate: deficiency.due_date,\r\n        status: newStatus\r\n      });\r\n\r\n      // Log audit entry\r\n      await window.api.auditLog.create({\r\n        userId: currentUser?.id || null,\r\n        username: currentUser?.username || 'Unknown User',\r\n        action: 'update',\r\n        entityType: 'deficiency',\r\n        entityId: deficiencyId,\r\n        oldValues: JSON.stringify({ status: oldStatus }),\r\n        newValues: JSON.stringify({ status: newStatus }),\r\n        ipAddress: null,\r\n        userAgent: navigator.userAgent\r\n      });\r\n\r\n      fetchDeficiencies();\r\n    } catch (error) {\r\n      console.error('Error updating deficiency status:', error);\r\n      alert('Failed to update deficiency status. Please try again.');\r\n    }\r\n  };\r\n\r\n  const closeDeficiency = async (deficiencyId) => {\r\n    try {\r\n      const verificationSignature = currentUser?.full_name || 'Unknown User';\r\n      await window.api.deficiencies.close(deficiencyId, verificationSignature);\r\n\r\n      // Log audit entry\r\n      await window.api.auditLog.create({\r\n        userId: currentUser?.id || null,\r\n        username: currentUser?.username || 'Unknown User',\r\n        action: 'close',\r\n        entityType: 'deficiency',\r\n        entityId: deficiencyId,\r\n        oldValues: JSON.stringify({ status: 'verified' }),\r\n        newValues: JSON.stringify({ status: 'closed', verificationSignature }),\r\n        ipAddress: null,\r\n        userAgent: navigator.userAgent\r\n      });\r\n\r\n      fetchDeficiencies();\r\n    } catch (error) {\r\n      console.error('Error closing deficiency:', error);\r\n      alert('Failed to close deficiency. Please try again.');\r\n    }\r\n  };\r\n\r\n  const getSeverityColor = (severity) => {\r\n    switch (severity) {\r\n      case 'critical': return '#dc3545';\r\n      case 'major': return '#fd7e14';\r\n      case 'minor': return '#ffc107';\r\n      default: return '#6c757d';\r\n    }\r\n  };\r\n\r\n  const getStatusColor = (status) => {\r\n    switch (status) {\r\n      case 'open': return '#dc3545';\r\n      case 'in_progress': return '#ffc107';\r\n      case 'verified': return '#17a2b8';\r\n      case 'closed': return '#28a745';\r\n      default: return '#6c757d';\r\n    }\r\n  };\r\n\r\n  const formatDate = (dateString) => {\r\n    if (!dateString) return 'Not set';\r\n    return new Date(dateString).toLocaleDateString();\r\n  };\r\n\r\n  if (loading) {\r\n    return <div className=\"deficiencies-loading\">Loading deficiencies...</div>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"deficiencies\">\r\n      <div className=\"deficiencies-header\">\r\n        <h2>Deficiency Management</h2>\r\n        <div className=\"header-actions\">\r\n          <div className=\"deficiencies-filters\">\r\n            <label>Filter by status:</label>\r\n            <select value={filter} onChange={(e) => setFilter(e.target.value)}>\r\n              <option value=\"all\">All Deficiencies</option>\r\n              <option value=\"open\">Open</option>\r\n              <option value=\"in_progress\">In Progress</option>\r\n              <option value=\"verified\">Verified</option>\r\n              <option value=\"closed\">Closed</option>\r\n            </select>\r\n          </div>\r\n          <button \r\n            className=\"create-button\"\r\n            onClick={() => setShowCreateDeficiencyForm(true)}\r\n          >\r\n            + Create Deficiency\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {deficiencies.length === 0 ? (\r\n        <div className=\"no-deficiencies\">\r\n          <p>No deficiencies found for the selected filter.</p>\r\n        </div>\r\n      ) : (\r\n        <div className=\"deficiencies-grid\">\r\n          {deficiencies.map((deficiency) => (\r\n            <div key={deficiency.id} className=\"deficiency-card\">\r\n              <div className=\"deficiency-header\">\r\n                <div className=\"deficiency-badges\">\r\n                  <span \r\n                    className=\"severity-badge\" \r\n                    style={{ backgroundColor: getSeverityColor(deficiency.severity) }}\r\n                  >\r\n                    {deficiency.severity.toUpperCase()}\r\n                  </span>\r\n                  <span \r\n                    className=\"status-badge\" \r\n                    style={{ backgroundColor: getStatusColor(deficiency.status) }}\r\n                  >\r\n                    {deficiency.status.replace('_', ' ').toUpperCase()}\r\n                  </span>\r\n                  {deficiency.remove_from_service && (\r\n                    <span className=\"oos-badge\">OUT OF SERVICE</span>\r\n                  )}\r\n                </div>\r\n                <div className=\"deficiency-id\">#{deficiency.id}</div>\r\n              </div>\r\n\r\n              <div className=\"deficiency-details\">\r\n                <h4>Equipment: {deficiency.equipment_identifier}</h4>\r\n                {deficiency.component && (\r\n                  <p><strong>Component:</strong> {deficiency.component}</p>\r\n                )}\r\n                <p><strong>Description:</strong> {deficiency.description}</p>\r\n                {deficiency.corrective_action && (\r\n                  <p><strong>Corrective Action:</strong> {deficiency.corrective_action}</p>\r\n                )}\r\n                <p><strong>Created:</strong> {formatDate(deficiency.created_at)}</p>\r\n                {deficiency.due_date && (\r\n                  <p><strong>Due Date:</strong> {formatDate(deficiency.due_date)}</p>\r\n                )}\r\n                {deficiency.closed_at && (\r\n                  <p><strong>Closed:</strong> {formatDate(deficiency.closed_at)}</p>\r\n                )}\r\n              </div>\r\n\r\n              <div className=\"deficiency-actions\">\r\n                {deficiency.status === 'open' && (\r\n                  <>\r\n                    <button \r\n                      onClick={() => updateDeficiencyStatus(deficiency.id, 'in_progress')}\r\n                      className=\"progress-btn\"\r\n                    >\r\n                      Start Work\r\n                    </button>\r\n                    <button \r\n                      onClick={() => handleCreateWorkOrderFromDeficiency(deficiency)}\r\n                      className=\"create-wo-btn\"\r\n                    >\r\n                      Create Work Order\r\n                    </button>\r\n                  </>\r\n                )}\r\n                {deficiency.status === 'in_progress' && (\r\n                  <button \r\n                    onClick={() => updateDeficiencyStatus(deficiency.id, 'verified')}\r\n                    className=\"verify-btn\"\r\n                  >\r\n                    Mark Verified\r\n                  </button>\r\n                )}\r\n                {deficiency.status === 'verified' && (\r\n                  <button \r\n                    onClick={() => closeDeficiency(deficiency.id)}\r\n                    className=\"close-btn\"\r\n                  >\r\n                    Close Deficiency\r\n                  </button>\r\n                )}\r\n                {deficiency.status !== 'closed' && (\r\n                  <button \r\n                    onClick={() => {\r\n                      // In a real app, this would open an edit modal\r\n                      alert('Edit functionality would be implemented here');\r\n                    }}\r\n                    className=\"edit-btn\"\r\n                  >\r\n                    Edit\r\n                  </button>\r\n                )}\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n\r\n      {/* Create Deficiency Modal */}\r\n      {showCreateDeficiencyForm && (\r\n        <div className=\"modal-overlay\">\r\n          <div className=\"modal-content\">\r\n            <div className=\"modal-header\">\r\n              <h2>Create Deficiency</h2>\r\n              <button \r\n                className=\"close-button\"\r\n                onClick={() => setShowCreateDeficiencyForm(false)}\r\n              >\r\n                ×\r\n              </button>\r\n            </div>\r\n\r\n            <form onSubmit={handleCreateDeficiency} className=\"create-form\">\r\n              <div className=\"form-row\">\r\n                <div className=\"form-group\">\r\n                  <label>Equipment *</label>\r\n                  <select\r\n                    value={newDeficiency.equipmentId}\r\n                    onChange={(e) => setNewDeficiency({...newDeficiency, equipmentId: e.target.value})}\r\n                    required\r\n                  >\r\n                    <option value=\"\">Select Equipment</option>\r\n                    {equipment.map(eq => (\r\n                      <option key={eq.id} value={eq.id}>\r\n                        {eq.equipment_id} - {eq.type}\r\n                      </option>\r\n                    ))}\r\n                  </select>\r\n                </div>\r\n\r\n                <div className=\"form-group\">\r\n                  <label>Severity *</label>\r\n                  <select\r\n                    value={newDeficiency.severity}\r\n                    onChange={(e) => setNewDeficiency({...newDeficiency, severity: e.target.value})}\r\n                    required\r\n                  >\r\n                    <option value=\"minor\">Minor</option>\r\n                    <option value=\"major\">Major</option>\r\n                    <option value=\"critical\">Critical</option>\r\n                  </select>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"form-row\">\r\n                <div className=\"form-group\">\r\n                  <label>Component</label>\r\n                  <input\r\n                    type=\"text\"\r\n                    value={newDeficiency.component}\r\n                    onChange={(e) => setNewDeficiency({...newDeficiency, component: e.target.value})}\r\n                    placeholder=\"e.g., Hydraulic System, Wire Rope, Hook Block\"\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"form-group\">\r\n                  <label>Due Date</label>\r\n                  <input\r\n                    type=\"date\"\r\n                    value={newDeficiency.dueDate}\r\n                    onChange={(e) => setNewDeficiency({...newDeficiency, dueDate: e.target.value})}\r\n                  />\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"form-group\">\r\n                <label>Description *</label>\r\n                <textarea\r\n                  value={newDeficiency.description}\r\n                  onChange={(e) => setNewDeficiency({...newDeficiency, description: e.target.value})}\r\n                  required\r\n                  rows=\"3\"\r\n                  placeholder=\"Detailed description of the deficiency\"\r\n                />\r\n              </div>\r\n\r\n              <div className=\"form-group\">\r\n                <label>Corrective Action</label>\r\n                <textarea\r\n                  value={newDeficiency.correctiveAction}\r\n                  onChange={(e) => setNewDeficiency({...newDeficiency, correctiveAction: e.target.value})}\r\n                  rows=\"3\"\r\n                  placeholder=\"Required corrective action to resolve the deficiency\"\r\n                />\r\n              </div>\r\n\r\n              <div className=\"form-group\">\r\n                <label className=\"checkbox-label\">\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={newDeficiency.removeFromService}\r\n                    onChange={(e) => setNewDeficiency({...newDeficiency, removeFromService: e.target.checked})}\r\n                  />\r\n                  Remove equipment from service\r\n                </label>\r\n              </div>\r\n\r\n              <div className=\"form-actions\">\r\n                <button type=\"button\" onClick={() => setShowCreateDeficiencyForm(false)} className=\"cancel-button\">\r\n                  Cancel\r\n                </button>\r\n                <button type=\"submit\" className=\"submit-button\">\r\n                  Create Deficiency\r\n                </button>\r\n              </div>\r\n            </form>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Deficiencies;\r\n"],"names":["currentUser","useUser","deficiencies","setDeficiencies","useState","equipment","setEquipment","filter","setFilter","loading","setLoading","showCreateDeficiencyForm","setShowCreateDeficiencyForm","newDeficiency","setNewDeficiency","equipmentId","severity","removeFromService","description","component","correctiveAction","dueDate","useEffect","loadData","async","deficienciesResult","equipmentResult","Promise","all","window","api","getAll","getByStatus","error","console","fetchDeficiencies","result","updateDeficiencyStatus","deficiencyId","newStatus","deficiency","find","d","id","oldStatus","status","update","remove_from_service","corrective_action","due_date","auditLog","create","userId","username","action","entityType","entityId","oldValues","JSON","stringify","newValues","ipAddress","userAgent","navigator","alert","getSeverityColor","getStatusColor","formatDate","dateString","Date","toLocaleDateString","_jsx","className","children","_jsxs","value","onChange","e","target","onClick","length","map","style","backgroundColor","toUpperCase","replace","equipment_identifier","created_at","closed_at","_Fragment","equipmentItem","eq","equipment_id","woNumber","getFullYear","String","now","slice","workOrderData","title","workType","priority","assignedTo","estimatedHours","createdBy","full_name","scheduledDate","createWOResult","workOrders","createdWOId","lastID","linkToWorkOrder","work_order_id","handleCreateWorkOrderFromDeficiency","verificationSignature","close","closeDeficiency","onSubmit","preventDefault","createResult","parseInt","inspectionItemId","createdDeficiencyId","required","type","placeholder","rows","checked"],"sourceRoot":""}